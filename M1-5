{
  "nbformat": 4,
  "nbformat_minor": 0,
  "metadata": {
    "colab": {
      "provenance": []
    },
    "kernelspec": {
      "name": "python3",
      "display_name": "Python 3"
    },
    "language_info": {
      "name": "python"
    },
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "1ca1f6eb62d14d0eb62595d0c741c4a7": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_c051a33e4a28435c9510f4803485defb",
              "IPY_MODEL_4b8b545a1a5b45c0a2069bbb032e51e1",
              "IPY_MODEL_78107711447b44bbb6126c356ac0ff46"
            ],
            "layout": "IPY_MODEL_ef744cf097dd4b71976c4c34218c06a9"
          }
        },
        "c051a33e4a28435c9510f4803485defb": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_7a5946760c884f34ad4700121f498a2b",
            "placeholder": "​",
            "style": "IPY_MODEL_97cbb94cb29445f4aaf024d2d8a1a01d",
            "value": "100%"
          }
        },
        "4b8b545a1a5b45c0a2069bbb032e51e1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_7db743892aa14415a65c5c821cbeb689",
            "max": 15,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_6a51d65d3b19401c89d784dc265a8d7e",
            "value": 15
          }
        },
        "78107711447b44bbb6126c356ac0ff46": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_f268b1ebdc3544b28a28949ea49e7555",
            "placeholder": "​",
            "style": "IPY_MODEL_b57a92602c9a41d5aadb27e63838c812",
            "value": " 15/15 [00:00&lt;00:00, 675.43it/s]"
          }
        },
        "ef744cf097dd4b71976c4c34218c06a9": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "7a5946760c884f34ad4700121f498a2b": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "97cbb94cb29445f4aaf024d2d8a1a01d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "7db743892aa14415a65c5c821cbeb689": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "6a51d65d3b19401c89d784dc265a8d7e": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "f268b1ebdc3544b28a28949ea49e7555": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b57a92602c9a41d5aadb27e63838c812": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        }
      }
    }
  },
  "cells": [
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "RR93R7hvqc1e",
        "outputId": "23c34a45-c3df-4412-8fdd-09696d27ccb1"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/70.3 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m70.3/70.3 kB\u001b[0m \u001b[31m2.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n",
            "  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n",
            "  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n",
            "  Building wheel for implicit (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n"
          ]
        }
      ],
      "source": [
        "!pip -q install pandas numpy scipy scikit-learn tabulate implicit==0.7.2"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "##importanting the needed libraries\n",
        "import os, math, time, json, gzip, pickle\n",
        "from collections import defaultdict\n",
        "from typing import List, Dict, Set\n",
        "import numpy as np\n",
        "import pandas as pd\n",
        "from scipy import sparse\n",
        "from tabulate import tabulate\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "import implicit\n",
        "\n",
        "DATA_DIR = \"/content\"\n",
        "RATINGS_FILE = os.path.join(DATA_DIR, \"ratings.csv\")\n",
        "MOVIES_FILE  = os.path.join(DATA_DIR, \"movies.csv\")\n",
        "LINKS_FILE   = os.path.join(DATA_DIR, \"links.csv\")\n",
        "\n",
        "K = 20\n",
        "MIN_INTERACTIONS = 5\n",
        "EVAL_USERS_CAP = 5000\n",
        "RATING_THRESHOLD = 3.5\n",
        "\n",
        "ALS_FACTORS = 64\n",
        "ALS_REG     = 0.01\n",
        "ALS_ITERS   = 15\n",
        "\n",
        "RANDOM_SEED = 42\n",
        "np.random.seed(RANDOM_SEED)\n",
        "\n",
        "OUT_DIR = \"/content/out_eval\"\n",
        "REGISTRY = \"/content/model_registry/v0.1\"\n",
        "os.makedirs(OUT_DIR, exist_ok=True)\n",
        "os.makedirs(REGISTRY, exist_ok=True)\n",
        "\n",
        "print(\"Looking for files:\")\n",
        "for p in [RATINGS_FILE, MOVIES_FILE, LINKS_FILE]:\n",
        "    print( p, \"exists?\" , os.path.exists(p))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "KDeg1PgNrN6f",
        "outputId": "220f61f4-403b-4a0a-b616-351fc55a14c1"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Looking for files:\n",
            "/content/ratings.csv exists? True\n",
            "/content/movies.csv exists? True\n",
            "/content/links.csv exists? True\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import files\n",
        "uploaded = files.upload()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 74
        },
        "id": "5A9neDDSvbiz",
        "outputId": "07fbe0e7-14fb-4b01-8458-00ee447bac54"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": [
              "\n",
              "     <input type=\"file\" id=\"files-03570748-606e-4ec2-addd-57346398cf98\" name=\"files[]\" multiple disabled\n",
              "        style=\"border:none\" />\n",
              "     <output id=\"result-03570748-606e-4ec2-addd-57346398cf98\">\n",
              "      Upload widget is only available when the cell has been executed in the\n",
              "      current browser session. Please rerun this cell to enable.\n",
              "      </output>\n",
              "      <script>// Copyright 2017 Google LLC\n",
              "//\n",
              "// Licensed under the Apache License, Version 2.0 (the \"License\");\n",
              "// you may not use this file except in compliance with the License.\n",
              "// You may obtain a copy of the License at\n",
              "//\n",
              "//      http://www.apache.org/licenses/LICENSE-2.0\n",
              "//\n",
              "// Unless required by applicable law or agreed to in writing, software\n",
              "// distributed under the License is distributed on an \"AS IS\" BASIS,\n",
              "// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",
              "// See the License for the specific language governing permissions and\n",
              "// limitations under the License.\n",
              "\n",
              "/**\n",
              " * @fileoverview Helpers for google.colab Python module.\n",
              " */\n",
              "(function(scope) {\n",
              "function span(text, styleAttributes = {}) {\n",
              "  const element = document.createElement('span');\n",
              "  element.textContent = text;\n",
              "  for (const key of Object.keys(styleAttributes)) {\n",
              "    element.style[key] = styleAttributes[key];\n",
              "  }\n",
              "  return element;\n",
              "}\n",
              "\n",
              "// Max number of bytes which will be uploaded at a time.\n",
              "const MAX_PAYLOAD_SIZE = 100 * 1024;\n",
              "\n",
              "function _uploadFiles(inputId, outputId) {\n",
              "  const steps = uploadFilesStep(inputId, outputId);\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  // Cache steps on the outputElement to make it available for the next call\n",
              "  // to uploadFilesContinue from Python.\n",
              "  outputElement.steps = steps;\n",
              "\n",
              "  return _uploadFilesContinue(outputId);\n",
              "}\n",
              "\n",
              "// This is roughly an async generator (not supported in the browser yet),\n",
              "// where there are multiple asynchronous steps and the Python side is going\n",
              "// to poll for completion of each step.\n",
              "// This uses a Promise to block the python side on completion of each step,\n",
              "// then passes the result of the previous step as the input to the next step.\n",
              "function _uploadFilesContinue(outputId) {\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  const steps = outputElement.steps;\n",
              "\n",
              "  const next = steps.next(outputElement.lastPromiseValue);\n",
              "  return Promise.resolve(next.value.promise).then((value) => {\n",
              "    // Cache the last promise value to make it available to the next\n",
              "    // step of the generator.\n",
              "    outputElement.lastPromiseValue = value;\n",
              "    return next.value.response;\n",
              "  });\n",
              "}\n",
              "\n",
              "/**\n",
              " * Generator function which is called between each async step of the upload\n",
              " * process.\n",
              " * @param {string} inputId Element ID of the input file picker element.\n",
              " * @param {string} outputId Element ID of the output display.\n",
              " * @return {!Iterable<!Object>} Iterable of next steps.\n",
              " */\n",
              "function* uploadFilesStep(inputId, outputId) {\n",
              "  const inputElement = document.getElementById(inputId);\n",
              "  inputElement.disabled = false;\n",
              "\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  outputElement.innerHTML = '';\n",
              "\n",
              "  const pickedPromise = new Promise((resolve) => {\n",
              "    inputElement.addEventListener('change', (e) => {\n",
              "      resolve(e.target.files);\n",
              "    });\n",
              "  });\n",
              "\n",
              "  const cancel = document.createElement('button');\n",
              "  inputElement.parentElement.appendChild(cancel);\n",
              "  cancel.textContent = 'Cancel upload';\n",
              "  const cancelPromise = new Promise((resolve) => {\n",
              "    cancel.onclick = () => {\n",
              "      resolve(null);\n",
              "    };\n",
              "  });\n",
              "\n",
              "  // Wait for the user to pick the files.\n",
              "  const files = yield {\n",
              "    promise: Promise.race([pickedPromise, cancelPromise]),\n",
              "    response: {\n",
              "      action: 'starting',\n",
              "    }\n",
              "  };\n",
              "\n",
              "  cancel.remove();\n",
              "\n",
              "  // Disable the input element since further picks are not allowed.\n",
              "  inputElement.disabled = true;\n",
              "\n",
              "  if (!files) {\n",
              "    return {\n",
              "      response: {\n",
              "        action: 'complete',\n",
              "      }\n",
              "    };\n",
              "  }\n",
              "\n",
              "  for (const file of files) {\n",
              "    const li = document.createElement('li');\n",
              "    li.append(span(file.name, {fontWeight: 'bold'}));\n",
              "    li.append(span(\n",
              "        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +\n",
              "        `last modified: ${\n",
              "            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :\n",
              "                                    'n/a'} - `));\n",
              "    const percent = span('0% done');\n",
              "    li.appendChild(percent);\n",
              "\n",
              "    outputElement.appendChild(li);\n",
              "\n",
              "    const fileDataPromise = new Promise((resolve) => {\n",
              "      const reader = new FileReader();\n",
              "      reader.onload = (e) => {\n",
              "        resolve(e.target.result);\n",
              "      };\n",
              "      reader.readAsArrayBuffer(file);\n",
              "    });\n",
              "    // Wait for the data to be ready.\n",
              "    let fileData = yield {\n",
              "      promise: fileDataPromise,\n",
              "      response: {\n",
              "        action: 'continue',\n",
              "      }\n",
              "    };\n",
              "\n",
              "    // Use a chunked sending to avoid message size limits. See b/62115660.\n",
              "    let position = 0;\n",
              "    do {\n",
              "      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);\n",
              "      const chunk = new Uint8Array(fileData, position, length);\n",
              "      position += length;\n",
              "\n",
              "      const base64 = btoa(String.fromCharCode.apply(null, chunk));\n",
              "      yield {\n",
              "        response: {\n",
              "          action: 'append',\n",
              "          file: file.name,\n",
              "          data: base64,\n",
              "        },\n",
              "      };\n",
              "\n",
              "      let percentDone = fileData.byteLength === 0 ?\n",
              "          100 :\n",
              "          Math.round((position / fileData.byteLength) * 100);\n",
              "      percent.textContent = `${percentDone}% done`;\n",
              "\n",
              "    } while (position < fileData.byteLength);\n",
              "  }\n",
              "\n",
              "  // All done.\n",
              "  yield {\n",
              "    response: {\n",
              "      action: 'complete',\n",
              "    }\n",
              "  };\n",
              "}\n",
              "\n",
              "scope.google = scope.google || {};\n",
              "scope.google.colab = scope.google.colab || {};\n",
              "scope.google.colab._files = {\n",
              "  _uploadFiles,\n",
              "  _uploadFilesContinue,\n",
              "};\n",
              "})(self);\n",
              "</script> "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saving links.csv to links.csv\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from google.colab import files\n",
        "uploaded = files.upload()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 74
        },
        "id": "3V0scbluvqve",
        "outputId": "c1c916ca-ccb7-40b5-f08d-0aa71c22227f"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": [
              "\n",
              "     <input type=\"file\" id=\"files-0472ed8a-aeb7-4a0b-b2f1-9ca5d012ef1c\" name=\"files[]\" multiple disabled\n",
              "        style=\"border:none\" />\n",
              "     <output id=\"result-0472ed8a-aeb7-4a0b-b2f1-9ca5d012ef1c\">\n",
              "      Upload widget is only available when the cell has been executed in the\n",
              "      current browser session. Please rerun this cell to enable.\n",
              "      </output>\n",
              "      <script>// Copyright 2017 Google LLC\n",
              "//\n",
              "// Licensed under the Apache License, Version 2.0 (the \"License\");\n",
              "// you may not use this file except in compliance with the License.\n",
              "// You may obtain a copy of the License at\n",
              "//\n",
              "//      http://www.apache.org/licenses/LICENSE-2.0\n",
              "//\n",
              "// Unless required by applicable law or agreed to in writing, software\n",
              "// distributed under the License is distributed on an \"AS IS\" BASIS,\n",
              "// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",
              "// See the License for the specific language governing permissions and\n",
              "// limitations under the License.\n",
              "\n",
              "/**\n",
              " * @fileoverview Helpers for google.colab Python module.\n",
              " */\n",
              "(function(scope) {\n",
              "function span(text, styleAttributes = {}) {\n",
              "  const element = document.createElement('span');\n",
              "  element.textContent = text;\n",
              "  for (const key of Object.keys(styleAttributes)) {\n",
              "    element.style[key] = styleAttributes[key];\n",
              "  }\n",
              "  return element;\n",
              "}\n",
              "\n",
              "// Max number of bytes which will be uploaded at a time.\n",
              "const MAX_PAYLOAD_SIZE = 100 * 1024;\n",
              "\n",
              "function _uploadFiles(inputId, outputId) {\n",
              "  const steps = uploadFilesStep(inputId, outputId);\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  // Cache steps on the outputElement to make it available for the next call\n",
              "  // to uploadFilesContinue from Python.\n",
              "  outputElement.steps = steps;\n",
              "\n",
              "  return _uploadFilesContinue(outputId);\n",
              "}\n",
              "\n",
              "// This is roughly an async generator (not supported in the browser yet),\n",
              "// where there are multiple asynchronous steps and the Python side is going\n",
              "// to poll for completion of each step.\n",
              "// This uses a Promise to block the python side on completion of each step,\n",
              "// then passes the result of the previous step as the input to the next step.\n",
              "function _uploadFilesContinue(outputId) {\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  const steps = outputElement.steps;\n",
              "\n",
              "  const next = steps.next(outputElement.lastPromiseValue);\n",
              "  return Promise.resolve(next.value.promise).then((value) => {\n",
              "    // Cache the last promise value to make it available to the next\n",
              "    // step of the generator.\n",
              "    outputElement.lastPromiseValue = value;\n",
              "    return next.value.response;\n",
              "  });\n",
              "}\n",
              "\n",
              "/**\n",
              " * Generator function which is called between each async step of the upload\n",
              " * process.\n",
              " * @param {string} inputId Element ID of the input file picker element.\n",
              " * @param {string} outputId Element ID of the output display.\n",
              " * @return {!Iterable<!Object>} Iterable of next steps.\n",
              " */\n",
              "function* uploadFilesStep(inputId, outputId) {\n",
              "  const inputElement = document.getElementById(inputId);\n",
              "  inputElement.disabled = false;\n",
              "\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  outputElement.innerHTML = '';\n",
              "\n",
              "  const pickedPromise = new Promise((resolve) => {\n",
              "    inputElement.addEventListener('change', (e) => {\n",
              "      resolve(e.target.files);\n",
              "    });\n",
              "  });\n",
              "\n",
              "  const cancel = document.createElement('button');\n",
              "  inputElement.parentElement.appendChild(cancel);\n",
              "  cancel.textContent = 'Cancel upload';\n",
              "  const cancelPromise = new Promise((resolve) => {\n",
              "    cancel.onclick = () => {\n",
              "      resolve(null);\n",
              "    };\n",
              "  });\n",
              "\n",
              "  // Wait for the user to pick the files.\n",
              "  const files = yield {\n",
              "    promise: Promise.race([pickedPromise, cancelPromise]),\n",
              "    response: {\n",
              "      action: 'starting',\n",
              "    }\n",
              "  };\n",
              "\n",
              "  cancel.remove();\n",
              "\n",
              "  // Disable the input element since further picks are not allowed.\n",
              "  inputElement.disabled = true;\n",
              "\n",
              "  if (!files) {\n",
              "    return {\n",
              "      response: {\n",
              "        action: 'complete',\n",
              "      }\n",
              "    };\n",
              "  }\n",
              "\n",
              "  for (const file of files) {\n",
              "    const li = document.createElement('li');\n",
              "    li.append(span(file.name, {fontWeight: 'bold'}));\n",
              "    li.append(span(\n",
              "        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +\n",
              "        `last modified: ${\n",
              "            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :\n",
              "                                    'n/a'} - `));\n",
              "    const percent = span('0% done');\n",
              "    li.appendChild(percent);\n",
              "\n",
              "    outputElement.appendChild(li);\n",
              "\n",
              "    const fileDataPromise = new Promise((resolve) => {\n",
              "      const reader = new FileReader();\n",
              "      reader.onload = (e) => {\n",
              "        resolve(e.target.result);\n",
              "      };\n",
              "      reader.readAsArrayBuffer(file);\n",
              "    });\n",
              "    // Wait for the data to be ready.\n",
              "    let fileData = yield {\n",
              "      promise: fileDataPromise,\n",
              "      response: {\n",
              "        action: 'continue',\n",
              "      }\n",
              "    };\n",
              "\n",
              "    // Use a chunked sending to avoid message size limits. See b/62115660.\n",
              "    let position = 0;\n",
              "    do {\n",
              "      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);\n",
              "      const chunk = new Uint8Array(fileData, position, length);\n",
              "      position += length;\n",
              "\n",
              "      const base64 = btoa(String.fromCharCode.apply(null, chunk));\n",
              "      yield {\n",
              "        response: {\n",
              "          action: 'append',\n",
              "          file: file.name,\n",
              "          data: base64,\n",
              "        },\n",
              "      };\n",
              "\n",
              "      let percentDone = fileData.byteLength === 0 ?\n",
              "          100 :\n",
              "          Math.round((position / fileData.byteLength) * 100);\n",
              "      percent.textContent = `${percentDone}% done`;\n",
              "\n",
              "    } while (position < fileData.byteLength);\n",
              "  }\n",
              "\n",
              "  // All done.\n",
              "  yield {\n",
              "    response: {\n",
              "      action: 'complete',\n",
              "    }\n",
              "  };\n",
              "}\n",
              "\n",
              "scope.google = scope.google || {};\n",
              "scope.google.colab = scope.google.colab || {};\n",
              "scope.google.colab._files = {\n",
              "  _uploadFiles,\n",
              "  _uploadFilesContinue,\n",
              "};\n",
              "})(self);\n",
              "</script> "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Saving movies.csv to movies.csv\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd, numpy as np, time\n",
        "\n",
        "np.random.seed(42)\n",
        "users  = np.arange(1, 11)\n",
        "movies = np.arange(1, 21)\n",
        "\n",
        "rows = []\n",
        "for u in users:\n",
        "    rated = np.random.choice(movies, size=np.random.randint(5, 15), replace=False)\n",
        "    for m in rated:\n",
        "        rows.append({\n",
        "            \"userId\": u,\n",
        "            \"movieId\": m,\n",
        "            \"rating\": np.random.randint(1, 6),\n",
        "            \"timestamp\": int(time.time()) - np.random.randint(0, 100000)\n",
        "        })\n",
        "\n",
        "df = pd.DataFrame(rows)\n",
        "df.to_csv(\"/content/ratings.csv\", index=False)\n",
        "print(\"The ratings.csv:\", df.shape)\n",
        "df.head()\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 224
        },
        "id": "eMx48sqQxF7f",
        "outputId": "ae3417c9-b776-42f7-81b3-0e0ab230952b"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "The ratings.csv: (101, 4)\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "   userId  movieId  rating   timestamp\n",
              "0       1        1       2  1761685383\n",
              "1       1       18       4  1761607590\n",
              "2       1       16       4  1761605389\n",
              "3       1        2       5  1761597678\n",
              "4       1        9       1  1761665036"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-86f36976-f44f-45bb-a15d-af6c448e2647\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>userId</th>\n",
              "      <th>movieId</th>\n",
              "      <th>rating</th>\n",
              "      <th>timestamp</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1761685383</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>1</td>\n",
              "      <td>18</td>\n",
              "      <td>4</td>\n",
              "      <td>1761607590</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>1</td>\n",
              "      <td>16</td>\n",
              "      <td>4</td>\n",
              "      <td>1761605389</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>5</td>\n",
              "      <td>1761597678</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>1</td>\n",
              "      <td>9</td>\n",
              "      <td>1</td>\n",
              "      <td>1761665036</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-86f36976-f44f-45bb-a15d-af6c448e2647')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-86f36976-f44f-45bb-a15d-af6c448e2647 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-86f36976-f44f-45bb-a15d-af6c448e2647');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-6ca59ef4-d750-41f2-8ee8-b9045efa2014\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-6ca59ef4-d750-41f2-8ee8-b9045efa2014')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-6ca59ef4-d750-41f2-8ee8-b9045efa2014 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "df",
              "summary": "{\n  \"name\": \"df\",\n  \"rows\": 101,\n  \"fields\": [\n    {\n      \"column\": \"userId\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2,\n        \"min\": 1,\n        \"max\": 10,\n        \"num_unique_values\": 10,\n        \"samples\": [\n          9,\n          2,\n          6\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"movieId\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 5,\n        \"min\": 1,\n        \"max\": 20,\n        \"num_unique_values\": 20,\n        \"samples\": [\n          1,\n          20,\n          5\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"rating\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 1,\n        \"max\": 5,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          4,\n          3,\n          5\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"timestamp\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 30072,\n        \"min\": 1761593869,\n        \"max\": 1761689840,\n        \"num_unique_values\": 101,\n        \"samples\": [\n          1761617703,\n          1761664385,\n          1761674323\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 48
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "def load_ratings(path: str) -> pd.DataFrame:\n",
        "    if not os.path.exists(path):\n",
        "        raise FileNotFoundError(\"Upload ratings.csv to /content.\")\n",
        "    df = pd.read_csv(path)\n",
        "    need = {\"userId\",\"movieId\",\"rating\",\"timestamp\"}\n",
        "    if not need.issubset(df.columns):\n",
        "        raise ValueError(f\"ratings.csv must contain {need}, got {df.columns.tolist()}\")\n",
        "    df[\"timestamp\"] = df[\"timestamp\"].astype(int)\n",
        "    return df\n",
        "\n",
        "def load_movies(path: str) -> pd.DataFrame:\n",
        "    if not os.path.exists(path):\n",
        "        print(\"Warning: movies.csv not found — genre slices will be skipped.\")\n",
        "        return pd.DataFrame()\n",
        "    return pd.read_csv(path)\n",
        "\n",
        "ratings = load_ratings(RATINGS_FILE)\n",
        "movies  = load_movies(MOVIES_FILE)\n",
        "\n",
        "print(\"Ratings the shape:\", ratings.shape)\n",
        "ratings.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 224
        },
        "id": "HN4I1OqLukGZ",
        "outputId": "a670950a-9e8c-481e-f099-f3ba4be8823b"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Ratings the shape: (101, 4)\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "   userId  movieId  rating   timestamp\n",
              "0       1        1       2  1761684679\n",
              "1       1       18       4  1761606886\n",
              "2       1       16       4  1761604685\n",
              "3       1        2       5  1761596974\n",
              "4       1        9       1  1761664332"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-9140f95b-5a88-439d-9a9e-396ecf33b68b\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>userId</th>\n",
              "      <th>movieId</th>\n",
              "      <th>rating</th>\n",
              "      <th>timestamp</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>1761684679</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>1</td>\n",
              "      <td>18</td>\n",
              "      <td>4</td>\n",
              "      <td>1761606886</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>1</td>\n",
              "      <td>16</td>\n",
              "      <td>4</td>\n",
              "      <td>1761604685</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1</td>\n",
              "      <td>2</td>\n",
              "      <td>5</td>\n",
              "      <td>1761596974</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>1</td>\n",
              "      <td>9</td>\n",
              "      <td>1</td>\n",
              "      <td>1761664332</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9140f95b-5a88-439d-9a9e-396ecf33b68b')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-9140f95b-5a88-439d-9a9e-396ecf33b68b button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-9140f95b-5a88-439d-9a9e-396ecf33b68b');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-d2d84838-21a7-49ab-8dd1-a61f7fb98f5e\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-d2d84838-21a7-49ab-8dd1-a61f7fb98f5e')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-d2d84838-21a7-49ab-8dd1-a61f7fb98f5e button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "ratings",
              "summary": "{\n  \"name\": \"ratings\",\n  \"rows\": 101,\n  \"fields\": [\n    {\n      \"column\": \"userId\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2,\n        \"min\": 1,\n        \"max\": 10,\n        \"num_unique_values\": 10,\n        \"samples\": [\n          9,\n          2,\n          6\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"movieId\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 5,\n        \"min\": 1,\n        \"max\": 20,\n        \"num_unique_values\": 20,\n        \"samples\": [\n          1,\n          20,\n          5\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"rating\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 1,\n        \"max\": 5,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          4,\n          3,\n          5\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"timestamp\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 30072,\n        \"min\": 1761593165,\n        \"max\": 1761689136,\n        \"num_unique_values\": 101,\n        \"samples\": [\n          1761616999,\n          1761663681,\n          1761673619\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 29
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "cutoff_ts = np.quantile(ratings[\"timestamp\"].values, 0.8)\n",
        "train_df  = ratings[ratings[\"timestamp\"] <= cutoff_ts].copy()\n",
        "test_df   = ratings[ratings[\"timestamp\"] >  cutoff_ts].copy()\n",
        "\n",
        "train_counts = train_df.groupby(\"userId\")[\"movieId\"].count()\n",
        "eligible_users = set(train_counts[train_counts >= MIN_INTERACTIONS].index)\n",
        "train_items = set(train_df[\"movieId\"].unique())\n",
        "\n",
        "test_df = test_df[test_df[\"userId\"].isin(eligible_users)]\n",
        "test_df = test_df[test_df[\"movieId\"].isin(train_items)]\n",
        "\n",
        "if len(eligible_users) > EVAL_USERS_CAP:\n",
        "    keep = set(np.random.choice(list(eligible_users), size=EVAL_USERS_CAP, replace=False))\n",
        "    train_df = train_df[train_df[\"userId\"].isin(keep)]\n",
        "    test_df  = test_df[test_df[\"userId\"].isin(keep)]\n",
        "    eligible_users = keep\n",
        "\n",
        "print(f\"The Cutoff ts: {cutoff_ts}  (UTC {pd.to_datetime(cutoff_ts, unit='s', utc=True)})\")\n",
        "print(\"The Train and Test sizes:\", train_df.shape, test_df.shape)\n",
        "print(\"The Number of Eligible users:\", len(eligible_users))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "el2typ8tu2Pz",
        "outputId": "aeeafa78-97d3-436d-d595-2934492a98eb"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "The Cutoff ts: 1761671401.0  (UTC 2025-10-28 17:10:01+00:00)\n",
            "The Train and Test sizes: (81, 4) (20, 4)\n",
            "The Number of Eligible users: 10\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "train_pos = train_df[train_df[\"rating\"] >= RATING_THRESHOLD].copy()\n",
        "user_ids = np.sort(train_pos[\"userId\"].unique())\n",
        "item_ids = np.sort(train_pos[\"movieId\"].unique())\n",
        "uid2idx = {u:i for i,u in enumerate(user_ids)}\n",
        "iid2idx = {m:i for i,m in enumerate(item_ids)}\n",
        "\n",
        "rows = train_pos[\"userId\"].map(uid2idx).values\n",
        "cols = train_pos[\"movieId\"].map(iid2idx).values\n",
        "data = np.ones_like(rows, dtype=np.float32)\n",
        "\n",
        "user_item = sparse.coo_matrix((data, (rows, cols)), shape=(len(user_ids), len(item_ids))).tocsr()\n",
        "print(\"The CSR shape:\", user_item.shape, \"nnz:\", user_item.nnz)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IRZJNU2lxdN1",
        "outputId": "d67a0002-c2f2-46df-9e44-233f3196fd13"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "The CSR shape: (9, 17) nnz: 31\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "als = implicit.als.AlternatingLeastSquares(\n",
        "    factors=ALS_FACTORS, regularization=ALS_REG, iterations=ALS_ITERS, random_state=RANDOM_SEED\n",
        ")\n",
        "als.fit(user_item.T)\n",
        "\n",
        "with open(os.path.join(REGISTRY, \"uid2idx.pkl\"), \"wb\") as f: pickle.dump(uid2idx, f)\n",
        "with open(os.path.join(REGISTRY, \"iid2idx.pkl\"), \"wb\") as f: pickle.dump(iid2idx, f)\n",
        "np.save(os.path.join(REGISTRY, \"user_factors.npy\"), als.user_factors)\n",
        "np.save(os.path.join(REGISTRY, \"item_factors.npy\"), als.item_factors)\n",
        "print(\"The Model to Saved to\", REGISTRY)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 123,
          "referenced_widgets": [
            "1ca1f6eb62d14d0eb62595d0c741c4a7",
            "c051a33e4a28435c9510f4803485defb",
            "4b8b545a1a5b45c0a2069bbb032e51e1",
            "78107711447b44bbb6126c356ac0ff46",
            "ef744cf097dd4b71976c4c34218c06a9",
            "7a5946760c884f34ad4700121f498a2b",
            "97cbb94cb29445f4aaf024d2d8a1a01d",
            "7db743892aa14415a65c5c821cbeb689",
            "6a51d65d3b19401c89d784dc265a8d7e",
            "f268b1ebdc3544b28a28949ea49e7555",
            "b57a92602c9a41d5aadb27e63838c812"
          ]
        },
        "id": "ijbav1T8xjad",
        "outputId": "758bf6b8-56e3-418d-cf4b-dcab710630e5"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.12/dist-packages/implicit/utils.py:164: ParameterWarning: Method expects CSR input, and was passed csc_matrix instead. Converting to CSR took 0.00011467933654785156 seconds\n",
            "  warnings.warn(\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "  0%|          | 0/15 [00:00<?, ?it/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "1ca1f6eb62d14d0eb62595d0c741c4a7"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "The Model to Saved to /content/model_registry/v0.1\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "def precision_at_k(recs: List[int], truth: Set[int], k: int) -> float:\n",
        "    if k == 0: return 0.0\n",
        "    return sum(1 for x in recs[:k] if x in truth) / k\n",
        "def recall_at_k(recs: List[int], truth: Set[int], k: int) -> float:\n",
        "    if not truth: return 0.0\n",
        "    return sum(1 for x in recs[:k] if x in truth) / len(truth)\n",
        "def dcg_at_k(recs: List[int], truth: Set[int], k: int) -> float:\n",
        "    dcg = 0.0\n",
        "    for i, item in enumerate(recs[:k], start=1):\n",
        "        if item in truth:\n",
        "            dcg += 1.0 / math.log2(i+1)\n",
        "    return dcg\n",
        "def ndcg_at_k(recs: List[int], truth: Set[int], k: int) -> float:\n",
        "    ideal_hits = min(len(truth), k)\n",
        "    if ideal_hits == 0: return 0.0\n",
        "    ideal_dcg = sum(1.0 / math.log2(i+1) for i in range(1, ideal_hits+1))\n",
        "    return dcg_at_k(recs, truth, k) / ideal_dcg\n",
        "def apk(recs: List[int], truth: Set[int], k: int) -> float:\n",
        "    hits, s = 0, 0.0\n",
        "    for i, item in enumerate(recs[:k], start=1):\n",
        "        if item in truth:\n",
        "            hits += 1\n",
        "            s += hits / i\n",
        "    if not truth: return 0.0\n",
        "    return s / min(len(truth), k)"
      ],
      "metadata": {
        "id": "ybjnuzNKxonk"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "def recommend_items_for_uid(u_external: int, k: int = 100) -> list:\n",
        "    if u_external not in uid2idx:\n",
        "        return list(item_ids[:k])\n",
        "    u = uid2idx[u_external]\n",
        "    user_vector = user_items_csr[u]\n",
        "    if user_vector.shape[0] != 1:\n",
        "        user_vector = user_vector.reshape(1, -1)\n",
        "    recs = als.recommend(u, user_items_csr, N=k, filter_already_liked_items=True)\n",
        "    return [int(item_ids[iid]) for iid, _ in recs]"
      ],
      "metadata": {
        "id": "KG16gAjuxwX5"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "test_pos = test_df[(test_df[\"rating\"] >= RATING_THRESHOLD) & (test_df[\"movieId\"].isin(item_ids))].copy()\n",
        "from collections import defaultdict\n",
        "truth_by_user: Dict[int, Set[int]] = defaultdict(set)\n",
        "for u, mid in zip(test_pos[\"userId\"].values, test_pos[\"movieId\"].values):\n",
        "    truth_by_user[u].add(mid)\n",
        "pop_counts = train_pos.groupby(\"movieId\")[\"userId\"].count().sort_values(ascending=False)\n",
        "pop_ranking = pop_counts.index.to_numpy()\n",
        "\n",
        "user_items_csr = user_item\n",
        "def recommend_items_for_uid(u_external: int, k: int = 100) -> List[int]:\n",
        "    \"\"\"\n",
        "    Recommend top-k movieIds for a given external userId.\n",
        "    - Uses ALS if user is known to the model.\n",
        "    - Filters already-liked items from TRAIN to avoid leakage.\n",
        "    - Falls back to global popularity if user not in training index.\n",
        "    \"\"\"\n",
        "    if u_external not in uid2idx:\n",
        "        seen = set(train_df.loc[train_df[\"userId\"] == u_external, \"movieId\"].values)\n",
        "        recs = [int(m) for m in pop_ranking if m not in seen]\n",
        "        return recs[:k]\n",
        "\n",
        "    u = uid2idx[u_external]\n",
        "\n",
        "    try:\n",
        "        single_user_row = user_items_csr[u]\n",
        "        recs = als.recommend(\n",
        "            u,\n",
        "            single_user_row,\n",
        "            N=k,\n",
        "            filter_already_liked_items=True\n",
        "        )\n",
        "        rec_item_ids = [int(item_ids[iid]) for iid, _ in recs]\n",
        "    except Exception as e:\n",
        "        seen = set(train_df.loc[train_df[\"userId\"] == u_external, \"movieId\"].values)\n",
        "        rec_item_ids = [int(m) for m in pop_ranking if m not in seen][:k]\n",
        "\n",
        "    return rec_item_ids\n",
        "\n",
        "eval_users = [u for u in truth_by_user.keys() if (u in uid2idx) or (u in train_df[\"userId\"].values)]\n",
        "Ks = [5, 10, 20]\n",
        "\n",
        "agg = {f\"precision@{k}\":[] for k in Ks}\n",
        "agg.update({f\"recall@{k}\":[] for k in Ks})\n",
        "agg.update({f\"ndcg@{k}\":[] for k in Ks})\n",
        "agg.update({f\"map@{k}\":[] for k in Ks})\n",
        "\n",
        "for u in eval_users:\n",
        "    truth = truth_by_user[u]\n",
        "    recs = recommend_items_for_uid(u, k=max(Ks))\n",
        "    for k in Ks:\n",
        "        agg[f\"precision@{k}\"].append(precision_at_k(recs, truth, k))\n",
        "        agg[f\"recall@{k}\"].append(recall_at_k(recs, truth, k))\n",
        "        agg[f\"ndcg@{k}\"].append(ndcg_at_k(recs, truth, k))\n",
        "        agg[f\"map@{k}\"].append(apk(recs, truth, k))\n",
        "\n",
        "summary = {m: float(np.mean(v)) if len(v)>0 else float('nan') for m,v in agg.items()}\n",
        "print(tabulate(sorted(summary.items()), headers=[\"The metrics\",\"The means\"], floatfmt=\".4f\"))\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "9aBpXLWxx374",
        "outputId": "44fc5ec5-3613-4699-ff81-27063e097415"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "The metrics      The means\n",
            "-------------  -----------\n",
            "map@10              0.3565\n",
            "map@20              0.3793\n",
            "map@5               0.3208\n",
            "ndcg@10             0.5176\n",
            "ndcg@20             0.5604\n",
            "ndcg@5              0.4343\n",
            "precision@10        0.1250\n",
            "precision@20        0.0750\n",
            "precision@5         0.2000\n",
            "recall@10           0.8750\n",
            "recall@20           1.0000\n",
            "recall@5            0.6250\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#task 2\n",
        "train_user_pos = train_pos.groupby(\"userId\")[\"movieId\"].nunique()\n",
        "def bucket(n):\n",
        "    if n < 10: return \"cold(<10)\"\n",
        "    elif n < 50: return \"warm(10-49)\"\n",
        "    else: return \"hot(50+)\"\n",
        "buckets = train_user_pos.apply(bucket).to_dict()\n",
        "rows = []\n",
        "for u in eval_users:\n",
        "    truth = truth_by_user[u]\n",
        "    recs = recommend_items_for_uid(u, k=K)\n",
        "    b = buckets.get(u, \"unknown\")\n",
        "    rows.append({\n",
        "        \"userId\": u,\n",
        "        \"bucket\": b,\n",
        "        \"p@20\": precision_at_k(recs, truth, 20),\n",
        "        \"r@20\": recall_at_k(recs, truth, 20),\n",
        "        \"ndcg@20\": ndcg_at_k(recs, truth, 20),\n",
        "        \"map@20\": apk(recs, truth, 20),\n",
        "        \"train_positives\": int(train_user_pos.get(u, 0))\n",
        "    })\n",
        "\n",
        "seg = pd.DataFrame(rows)\n",
        "seg_summary = seg.groupby(\"bucket\")[[\"p@20\",\"r@20\",\"ndcg@20\",\"map@20\"]].mean().reset_index()\n",
        "display(seg_summary)\n",
        "seg_summary.to_csv(os.path.join(OUT_DIR, \"subpopulation_summary.csv\"), index=False)\n",
        "\n",
        "ax = seg_summary.plot(x=\"bucket\", y=\"ndcg@20\", kind=\"bar\", legend=True, title=\"NDCG@20 by User Activity Bucket\")\n",
        "ax.set_xlabel(\"The Bucket\"); ax.set_ylabel(\"The NDCG@20\"); plt.tight_layout(); plt.show()\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 559
        },
        "id": "X-C0nzWtz4WA",
        "outputId": "3e3b0b4b-2198-450a-8652-4f04945c9b83"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "      bucket   p@20  r@20   ndcg@20    map@20\n",
              "0  cold(<10)  0.075   1.0  0.560391  0.379275"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-24202d5b-adbc-4181-9234-af76bbe0b6b4\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>bucket</th>\n",
              "      <th>p@20</th>\n",
              "      <th>r@20</th>\n",
              "      <th>ndcg@20</th>\n",
              "      <th>map@20</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.075</td>\n",
              "      <td>1.0</td>\n",
              "      <td>0.560391</td>\n",
              "      <td>0.379275</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-24202d5b-adbc-4181-9234-af76bbe0b6b4')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-24202d5b-adbc-4181-9234-af76bbe0b6b4 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-24202d5b-adbc-4181-9234-af76bbe0b6b4');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "  <div id=\"id_0da7b8b3-557a-4030-82d6-62a8050e8963\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('seg_summary')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_0da7b8b3-557a-4030-82d6-62a8050e8963 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('seg_summary');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "seg_summary",
              "summary": "{\n  \"name\": \"seg_summary\",\n  \"rows\": 1,\n  \"fields\": [\n    {\n      \"column\": \"bucket\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"cold(<10)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"p@20\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": null,\n        \"min\": 0.07500000000000001,\n        \"max\": 0.07500000000000001,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0.07500000000000001\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"r@20\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": null,\n        \"min\": 1.0,\n        \"max\": 1.0,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          1.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ndcg@20\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": null,\n        \"min\": 0.5603910325425869,\n        \"max\": 0.5603910325425869,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0.5603910325425869\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"map@20\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": null,\n        \"min\": 0.37927489177489176,\n        \"max\": 0.37927489177489176,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0.37927489177489176\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 640x480 with 1 Axes>"
            ],
            "image/png": "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DysuLk6HDh3Kso709HR17dpV58+f1/vvv++wLSkpSfnz58+0T8YoYVJS0nWv08PDQy+88IL9vaenp1544QWdPXtW27ZtkySFhISodOnSDiM/e/fu1e7du/XMM89c9xw5UbRoUUnSV199lWnkLcPSpUvl4+Ojhx56yD6SFBcXp+DgYBUuXFhRUVEO/StUqJDtaFdWFixYoHbt2tm/J1WqVFFwcLDD9cfGxur7779Xjx49VK5cOYf9bTab0+e6WufOnXXlyhUtW7bM3rZ69WqdP39enTt3vqFjPvXUU/Ly8nKo/bvvvlNcXJzTf3fPP/+81qxZozVr1ujzzz/Xyy+/rOnTp2c5OckZn3/+uerVq6eOHTtm2va/n118fLxat26t6OhorV+/3mG0NaffAyAvEOwAJw0dOlSpqak5miH7vy5evCjpnyCXccsyI+hdS8Y+Gce42hdffKE1a9ZkWsIjOTlZ+/bt0/333y/p79uKX375pebPn6/nnntOTz75pL7++mt5eHjY9/H09NQ999yj2NjYLOvo27evVq1apVmzZqlevXoO2woUKKDk5ORM+1y+fNm+/XpKly6tQoUKObRVrVpVkuxLkLi5ualr165asWKFEhMTJf0dfry8vPTkk09e9xzOyPgHvWXLlnr88cc1cuRIlShRQu3bt9fHH3/scJ2HDh1SfHy8SpYs6RCwfX19dfHiRZ09e9bh2BUqVHC6jgMHDmjHjh267777dPjwYfurVatW+uqrr+yBP2OZm9xcB7BevXqqXr26w9I2ixcvVokSJfTAAw/c0DGLFi2qxx57TAsXLrS3LViwQAEBAU4fs0qVKgoJCVFISIg6deqkKVOmqHfv3po0aZL27NmT45qOHDni9OfWr18//fzzz1q7dq1q1arlsC2n3wMgL3hcvwsA6e9RsWeeeUYzZsy44WUV9u7dK0mqXLmyJKl69eqSpD179qh58+bX3Ldy5cry8PCwH+NqLVu2lCSHgCb9vQad9HdYkv4JRg0bNrT38fHxUbVq1ezvk5OTdfbsWRUvXjzTeUaOHKkPPvhAY8aMyfK5wFKlSmW55l/GKGdGHbkhNDRU48aN04oVK9SlSxctXLhQjz76qHx8fK653/VGDzOCYka/jEVpf/zxR61cuVLfffedevTooXfffVc//vijChcurPT0dJUsWTLLZ8ckZXqGzZmAm2H+/PmSpFdffVWvvvpqpu2ff/65wsLCnD5eTnXu3FmjR49WXFycihQpoi+//FJdunTJ9F3LidDQUC1dulSbN29WnTp19OWXX6p3795yc7vxsYYHH3xQU6ZM0ffff686depcs+/NrHfXvn17LVq0SGPGjNHcuXMdas7p9wDICwQ7IAeGDh2q+fPna+zYsTne9+LFi1q+fLnKli2rGjVqSJIee+wxRUREaP78+dcNdoUKFVKrVq20YcMGnTp1SgEBAdc9Z8aIYHx8vHx9feXv7y/JcYQiNTVVJ06csO8ze/ZsBQQE2EfJMkydOlUjRoxQv379sl0gNygoSFFRUUpISHCYQJGxOPP1JglIf08UuHTpksOoXcYizYGBgfa22rVrq379+lqwYIHKlCmjEydOZLo1nBVfX18VLFhQBw8ezHL7wYMHVbBgQYdJIZLUpEkTNWnSRKNHj9bChQvVtWtXLVq0SM8995wqVaqktWvX6r777stRaLseY4wWLlyo+++/X7179860/a233tKCBQsUFhamihUrSlKWwf9qOb0t27lzZ40cOVKff/65/Pz8lJCQoKeffvq6+13rPA8//LB8fX21YMECNW7cWImJiU5NILqW1NRUSY4j2vfcc0+m9fpSUlIyPU5RqVKl635uGTp06KDWrVure/fuKlKkiD788EOH4zj7PbjR2+PA9XArFsiBSpUq6ZlnntH06dPts0KdkZSUpGeffVZ//fWX3njjDft/1Js2baqHH35Ys2bNynKB4JSUFA0YMMD+ftiwYUpLS9MzzzyT5S1Z8z+L1hYuXFhlypSxB6uyZcsqODhYvXr10i+//KJDhw6pd+/eOnv2rOLi4jRhwgT169dP77zzjsM/PIsXL9Yrr7yirl27asKECdle5xNPPKG0tDTNmDHD3pacnKyPP/5YjRs3VtmyZa/7WaWmpmr69OkOn8H06dPl6+ur4OBgh77PPvusVq9erUmTJql48eJ65JFHrnt8d3d3tW7dWitXrnQItJJ04sQJrVy5Uq1bt7Y/k3ju3LlMn2tGQM24HfvUU08pLS1Nb731VpbXc6O/8rBp0yYdO3ZMYWFheuKJJzK9OnfurKioKJ0+fVq+vr5q0aKFZs+enem6rq4/IzA7W1ONGjVUp04dLV68WIsXL1apUqXUokWL6+5XqFChbM/h4eGhLl26aMmSJfrk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AACAm+R0sCtfvnxe1gEAAICb5HSwO3HihFP9ypUrd8PFAAAA4MY5HewCAwOzfIbu6mfrbDabUlNTc686AAAAOM3pYLdjx44s240xWrRokd577z0VLlw41woDAABAzjgd7OrVq5epbe3atRo8eLB+/fVXDRo0SP3798/V4gAAAOC8HC13kmH79u167bXX9MMPP+i5557TN998o5IlS+Z2bQAAAMgBp395QpKOHDmizp07q1GjRvL19dX+/fs1ZcoUQh0AAMBtwOlg17t3b9WsWVPx8fH65ZdftHDhQlWsWDEvawMAAEAOOH0rdtq0afLy8tLZs2fVo0ePbPtt3749VwoDAABAzjgd7IYPH56XdQAAAOAmEewAAAAsIkeTJwAAAHD7ItgBAABYBMEOAADAIgh2AAAAFnFTwe7y5cu5VQcAAABuUo6DXXp6ut566y0FBASocOHCOnr0qCTpv//9rz766KNcLxAAAADOyXGwGzVqlD755BO988478vT0tLfXrl1bs2bNytXiAAAA4LwcB7u5c+dqxowZ6tq1q9zd3e3t9erVU3R0dK4WBwAAAOflONidOnVKlStXztSenp6uK1eu5EpRAAAAyLkcB7uaNWvqhx9+yNT+2WefqX79+rlSFAAAAHLO6Z8UyzBs2DB169ZNp06dUnp6upYtW6aDBw9q7ty5+uqrr/KiRgAAADghxyN27du318qVK7V27VoVKlRIw4YN04EDB7Ry5Uo99NBDeVEjAAAAnJDjETtJat68udasWZPbtQAAAOAm3FCwk6SUlBSdPXtW6enpDu3lypW76aIAAACQczkOdocOHVKPHj20efNmh3ZjjGw2m9LS0nKtOAAAADgvx8Gue/fu8vDw0FdffaVSpUrJZrPlRV0AAADIoRwHu507d2rbtm2qXr16XtQDAACAG3RD69jFxcXlRS0AAAC4CU4Fu4SEBPtr7NixGjRokNavX68///zTYVtCQkJe1wsAAIBsOHUrtmjRog7P0hlj9OCDDzr0YfIEAACAazkV7KKiovK6DgAAANwkp4Jdy5Yt9eabb2rAgAEqWLBgXtcEAACAG+D05ImRI0fq4sWLeVkLAAAAboLTwc4Yk5d1AAAA4CblaLkTFiMGAAC4feUo2FWtWlXFihW75utGTJ06VYGBgfLy8lLjxo21devWbPvOnDlTzZs31z333KN7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\n"
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "N_MINUTES = 60\n",
        "TOPK_FOR_RESPONSE = 20\n",
        "req_rows, resp_rows = [], []\n",
        "base_ts = int(cutoff_ts)\n",
        "\n",
        "for i, u in enumerate(eval_users):\n",
        "    ts = base_ts + 60*(i+1)\n",
        "    req_rows.append({\"ts\": ts, \"user_id\": int(u), \"k\": TOPK_FOR_RESPONSE})\n",
        "    recs = recommend_items_for_uid(u, k=TOPK_FOR_RESPONSE)\n",
        "    resp_rows.append({\n",
        "        \"ts\": ts+1, \"user_id\": int(u), \"status\": 200, \"latency_ms\": int(np.random.randint(40,120)),\n",
        "        \"k\": TOPK_FOR_RESPONSE, \"movie_ids\": json.dumps(recs), \"model_version\": \"als_v1\"\n",
        "    })\n",
        "\n",
        "reco_requests  = pd.DataFrame(req_rows)\n",
        "reco_responses = pd.DataFrame(resp_rows)\n",
        "\n",
        "wtest = test_df[(test_df[\"rating\"] >= RATING_THRESHOLD) & (test_df[\"movieId\"].isin(item_ids))].copy()\n",
        "wtest[\"ts\"] = (wtest[\"timestamp\"] // 60) * 60\n",
        "watch_events = wtest[[\"ts\",\"userId\",\"movieId\"]].rename(columns={\"userId\":\"user_id\",\"movieId\":\"movie_id\"})\n",
        "\n",
        "reco_requests.to_csv(os.path.join(OUT_DIR, \"reco_requests.csv\"), index=False)\n",
        "reco_responses.to_csv(os.path.join(OUT_DIR, \"reco_responses.csv\"), index=False)\n",
        "watch_events.to_csv(os.path.join(OUT_DIR, \"watch_events.csv\"), index=False)\n",
        "\n",
        "print(\"The Logs written:\", OUT_DIR)\n",
        "reco_responses.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 193
        },
        "id": "IBegy3VT10Ik",
        "outputId": "a3d63005-bca1-48d3-cb27-abe438510dc6"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "The Logs written: /content/out_eval\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "           ts  user_id  status  latency_ms   k  \\\n",
              "0  1761671462        1     200          69  20   \n",
              "1  1761671522        2     200          58  20   \n",
              "2  1761671582        3     200          56  20   \n",
              "3  1761671642        6     200         102  20   \n",
              "\n",
              "                                  movie_ids model_version  \n",
              "0   [14, 3, 5, 13, 11, 7, 20, 6, 8, 15, 12]        als_v1  \n",
              "1          [14, 2, 16, 7, 18, 20, 4, 9, 12]        als_v1  \n",
              "2      [19, 3, 5, 13, 16, 18, 20, 9, 8, 15]        als_v1  \n",
              "3  [19, 14, 2, 5, 13, 16, 11, 7, 18, 6, 15]        als_v1  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-0dd73019-28ea-4ac1-ac92-882cd0771d45\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ts</th>\n",
              "      <th>user_id</th>\n",
              "      <th>status</th>\n",
              "      <th>latency_ms</th>\n",
              "      <th>k</th>\n",
              "      <th>movie_ids</th>\n",
              "      <th>model_version</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1761671462</td>\n",
              "      <td>1</td>\n",
              "      <td>200</td>\n",
              "      <td>69</td>\n",
              "      <td>20</td>\n",
              "      <td>[14, 3, 5, 13, 11, 7, 20, 6, 8, 15, 12]</td>\n",
              "      <td>als_v1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>1761671522</td>\n",
              "      <td>2</td>\n",
              "      <td>200</td>\n",
              "      <td>58</td>\n",
              "      <td>20</td>\n",
              "      <td>[14, 2, 16, 7, 18, 20, 4, 9, 12]</td>\n",
              "      <td>als_v1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>1761671582</td>\n",
              "      <td>3</td>\n",
              "      <td>200</td>\n",
              "      <td>56</td>\n",
              "      <td>20</td>\n",
              "      <td>[19, 3, 5, 13, 16, 18, 20, 9, 8, 15]</td>\n",
              "      <td>als_v1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>1761671642</td>\n",
              "      <td>6</td>\n",
              "      <td>200</td>\n",
              "      <td>102</td>\n",
              "      <td>20</td>\n",
              "      <td>[19, 14, 2, 5, 13, 16, 11, 7, 18, 6, 15]</td>\n",
              "      <td>als_v1</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0dd73019-28ea-4ac1-ac92-882cd0771d45')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-0dd73019-28ea-4ac1-ac92-882cd0771d45 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-0dd73019-28ea-4ac1-ac92-882cd0771d45');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-1da079f4-18a2-4126-b86d-aca0d90d1156\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-1da079f4-18a2-4126-b86d-aca0d90d1156')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-1da079f4-18a2-4126-b86d-aca0d90d1156 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "reco_responses",
              "summary": "{\n  \"name\": \"reco_responses\",\n  \"rows\": 4,\n  \"fields\": [\n    {\n      \"column\": \"ts\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 77,\n        \"min\": 1761671462,\n        \"max\": 1761671642,\n        \"num_unique_values\": 4,\n        \"samples\": [\n          1761671522,\n          1761671642,\n          1761671462\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"user_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2,\n        \"min\": 1,\n        \"max\": 6,\n        \"num_unique_values\": 4,\n        \"samples\": [\n          2,\n          6,\n          1\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"status\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 200,\n        \"max\": 200,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          200\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"latency_ms\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 21,\n        \"min\": 56,\n        \"max\": 102,\n        \"num_unique_values\": 4,\n        \"samples\": [\n          58\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"k\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 20,\n        \"max\": 20,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          20\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"movie_ids\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 4,\n        \"samples\": [\n          \"[14, 2, 16, 7, 18, 20, 4, 9, 12]\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"model_version\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"als_v1\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 44
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "resp = reco_responses.copy()\n",
        "resp[\"movie_ids_list\"] = resp[\"movie_ids\"].apply(lambda s: list(map(int, json.loads(s))) if isinstance(s, str) else [])\n",
        "resp[\"ts_end\"] = resp[\"ts\"] + N_MINUTES*60\n",
        "\n",
        "from collections import defaultdict\n",
        "watch_index = defaultdict(list)\n",
        "for row in watch_events.itertuples(index=False):\n",
        "    watch_index[row.user_id].append((int(row.ts), int(row.movie_id)))\n",
        "\n",
        "def response_success(row) -> int:\n",
        "    u = row.user_id\n",
        "    t0, t1 = int(row.ts), int(row.ts_end)\n",
        "    candidates = set(row.movie_ids_list)\n",
        "    for ts, mid in watch_index.get(u, []):\n",
        "        if t0 <= ts <= t1 and mid in candidates:\n",
        "            return 1\n",
        "    return 0\n",
        "\n",
        "resp[\"success\"] = resp.apply(response_success, axis=1)\n",
        "\n",
        "overall_success = resp[\"success\"].mean() if len(resp)>0 else float('nan')\n",
        "latency_p50 = float(np.percentile(resp[\"latency_ms\"], 50)) if len(resp)>0 else float('nan')\n",
        "latency_p95 = float(np.percentile(resp[\"latency_ms\"], 95)) if len(resp)>0 else float('nan')\n",
        "\n",
        "print(f\"Proxy success within {N_MINUTES} minutes: {overall_success:.4f}\")\n",
        "print(f\"Latency p50: {latency_p50:.1f} ms | p95: {latency_p95:.1f} ms\")\n",
        "\n",
        "def success_at_k(k: int) -> float:\n",
        "    tmp = resp.copy()\n",
        "    tmp[\"movie_ids_list\"] = tmp[\"movie_ids_list\"].apply(lambda xs: xs[:k])\n",
        "    tmp[\"success_k\"] = tmp.apply(response_success, axis=1)\n",
        "    return tmp[\"success_k\"].mean()\n",
        "\n",
        "for k in [5,10,20]:\n",
        "    print(f\"The Success@{k}: {success_at_k(k):.4f}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "GVC0C77X2hV-",
        "outputId": "cd5a7ccb-61b5-4566-b5b2-81c625273d23"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Proxy success within 60 minutes: 0.0000\n",
            "Latency p50: 63.5 ms | p95: 97.0 ms\n",
            "The Success@5: 0.0000\n",
            "The Success@10: 0.0000\n",
            "The Success@20: 0.0000\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "print(\"Artifacts:\")\n",
        "print(\"The Model Registry:\", REGISTRY)\n",
        "print(\"The Eval Outputs:\", OUT_DIR)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "nmJ5WHU22q8V",
        "outputId": "b58a6950-0e33-468d-ba4d-6542705b2317"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Artifacts:\n",
            "The Model Registry: /content/model_registry/v0.1\n",
            "The Eval Outputs: /content/out_eval\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "import pandas as pd, numpy as np\n",
        "\n",
        "if \"train_df\" not in locals():\n",
        "    np.random.seed(42)\n",
        "    users  = np.arange(1, 11)\n",
        "    movies = np.arange(1, 21)\n",
        "    rows = []\n",
        "    for u in users:\n",
        "        rated = np.random.choice(movies, size=np.random.randint(5, 10), replace=False)\n",
        "        for m in rated:\n",
        "            rows.append({\"userId\": u, \"movieId\": m, \"rating\": np.random.randint(1,6), \"timestamp\": int(1e9+np.random.randint(0,1e5))})\n",
        "    df = pd.DataFrame(rows)\n",
        "    cutoff_ts = np.quantile(df[\"timestamp\"].values, 0.8)\n",
        "    train_df = df[df[\"timestamp\"] <= cutoff_ts].copy()\n",
        "    test_df  = df[df[\"timestamp\"] >  cutoff_ts].copy()\n",
        "\n",
        "RATING_THRESHOLD = 3.5\n",
        "train_pos = train_df[train_df[\"rating\"] >= RATING_THRESHOLD].copy()\n",
        "\n",
        "pop_counts = train_pos.groupby(\"movieId\")[\"userId\"].count().sort_values(ascending=False)\n",
        "pop_ranking = pop_counts.index.to_numpy()\n",
        "\n",
        "print(\" Variables ready:\")\n",
        "print(\"train_pos:\", train_pos.shape, \"| pop_ranking length:\", len(pop_ranking))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Qe_1L5JEiI3x",
        "outputId": "e7bb61b5-f53d-41ca-cd2a-783266b8124b"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            " Variables ready:\n",
            "train_pos: (20, 4) | pop_ranking length: 12\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import numpy as np\n",
        "from collections import defaultdict\n",
        "\n",
        "if \"train_df\" in locals() and \"test_df\" in locals():\n",
        "    RATING_THRESHOLD = 3.5\n",
        "\n",
        "    test_pos = test_df[(test_df[\"rating\"] >= RATING_THRESHOLD)].copy()\n",
        "    truth_by_user = defaultdict(set)\n",
        "    for u, mid in zip(test_pos[\"userId\"].values, test_pos[\"movieId\"].values):\n",
        "        truth_by_user[u].add(mid)\n",
        "    eval_users = sorted(list(set(test_pos[\"userId\"].unique())))\n",
        "    print(f\" eval_users ready: {len(eval_users)} users\")\n",
        "\n",
        "else:\n",
        "    print(\" Please make sure train_df and test_df are defined first.\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "rDHDRSL7iY3e",
        "outputId": "9319e65b-1fab-4c71-84fb-7fdd25f2e6dc"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            " eval_users ready: 6 users\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###MILESTONE 4!!!\n",
        "import numpy as np\n",
        "\n",
        "def recommend_items_for_uid(u_external: int, k: int = 20) -> list:\n",
        "    \"\"\"\n",
        "    Recommend top-k movieIds for a given userId using ALS (if available),\n",
        "    otherwise fall back to popularity ranking.\n",
        "    \"\"\"\n",
        "    if 'uid2idx' not in globals() or u_external not in uid2idx:\n",
        "        seen = set(train_df.loc[train_df[\"userId\"] == u_external, \"movieId\"].values)\n",
        "        recs = [int(m) for m in pop_ranking if m not in seen]\n",
        "        return recs[:k]\n",
        "\n",
        "    u = uid2idx[u_external]\n",
        "    try:\n",
        "        single_user_row = user_item[u]\n",
        "        recs = als.recommend(\n",
        "            u,\n",
        "            single_user_row,\n",
        "            N=k,\n",
        "            filter_already_liked_items=True\n",
        "        )\n",
        "        return [int(item_ids[iid]) for iid, _ in recs]\n",
        "    except Exception as e:\n",
        "        seen = set(train_df.loc[train_df[\"userId\"] == u_external, \"movieId\"].values)\n",
        "        recs = [int(m) for m in pop_ranking if m not in seen]\n",
        "        return recs[:k]\n",
        "\n",
        "print(\" recommend_items_for_uid() recreated and ready to use.\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "FlQs3KZrix5P",
        "outputId": "57c08a0a-5dee-498a-a556-f0fd72723e5b"
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            " recommend_items_for_uid() recreated and ready to use.\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###MILESTONE 4!!!\n",
        "import pandas as pd, numpy as np, time\n",
        "\n",
        "if \"test_df\" not in locals():\n",
        "    raise RuntimeError(\"Please run the earlier data split cell to create test_df.\")\n",
        "\n",
        "RATING_THRESHOLD = 3.5\n",
        "wtest = test_df[(test_df[\"rating\"] >= RATING_THRESHOLD)].copy()\n",
        "\n",
        "wtest[\"ts\"] = (wtest[\"timestamp\"] // 60) * 60\n",
        "watch_events = wtest[[\"ts\",\"userId\",\"movieId\"]].rename(\n",
        "    columns={\"userId\":\"user_id\",\"movieId\":\"movie_id\"}\n",
        ")\n",
        "\n",
        "print(f\" watch_events recreated: {len(watch_events)} events\")\n",
        "print(watch_events.head())\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "qs0EvumvjA2G",
        "outputId": "df5c22fd-862c-4634-8786-dc22502174b8"
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            " watch_events recreated: 7 events\n",
            "            ts  user_id  movie_id\n",
            "3   1000092960        1         2\n",
            "27  1000098780        4         4\n",
            "30  1000095240        5         1\n",
            "45  1000086180        7        16\n",
            "46  1000091880        7        18\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "###MILESTONE 4!!!\n",
        "##importanting libraries\n",
        "import uuid, hashlib, os, numpy as np, pandas as pd, json, math, random\n",
        "from datetime import datetime\n",
        "##adding the confugration\n",
        "ALPHA = 0.05\n",
        "N_MINUTES = 60\n",
        "K_RESP = 20\n",
        "random.seed(42)\n",
        "np.random.seed(42)\n",
        "\n",
        "try:\n",
        "    pop_ranking\n",
        "except NameError:\n",
        "    pop_counts = train_pos.groupby(\"movieId\")[\"userId\"].count().sort_values(ascending=False)\n",
        "    pop_ranking = pop_counts.index.to_numpy()\n",
        "\n",
        "def recommend_popularity(u_external: int, k: int = 100) -> list:\n",
        "    seen = set(train_df.loc[train_df[\"userId\"] == u_external, \"movieId\"].values)\n",
        "    recs = [int(mid) for mid in pop_ranking if mid not in seen]\n",
        "    return recs[:k]\n",
        "\n",
        "snapshot_payload = {\n",
        "    \"cutoff_ts\": int(cutoff_ts),#the snapshot\n",
        "    \"n_train\": int(len(train_df)),\n",
        "    \"n_test\": int(len(test_df)),\n",
        "    \"n_users\": int(train_df[\"userId\"].nunique()),\n",
        "    \"n_items\": int(train_df[\"movieId\"].nunique()),\n",
        "}\n",
        "data_snapshot_id = hashlib.sha1(json.dumps(snapshot_payload, sort_keys=True).encode()).hexdigest()\n",
        "\n",
        "pipeline_git_sha = \"git_sha_example_abcdef\"\n",
        "container_image_digest = \"sha256:container_digest_example_123456\"\n",
        "\n",
        "def assign_arm(user_id: int) -> str:\n",
        "    return \"A_CF\" if (user_id % 2 == 0) else \"B_POP\"\n",
        "\n",
        "exp_requests, exp_responses = [], []\n",
        "base_ts = int(cutoff_ts)\n",
        "success_window_secs = N_MINUTES * 60\n",
        "\n",
        "for i, u in enumerate(eval_users):\n",
        "    assign = assign_arm(int(u))\n",
        "    ts_req = base_ts + 60*(i+1)\n",
        "    req_id = str(uuid.uuid4())\n",
        "\n",
        "    exp_requests.append({\n",
        "        \"request_id\": req_id,\n",
        "        \"ts\": ts_req,\n",
        "        \"user_id\": int(u),\n",
        "        \"arm\": assign,\n",
        "        \"k\": K_RESP\n",
        "    })\n",
        "\n",
        "    if assign == \"A_CF\":\n",
        "        model_version = \"als_v1\"\n",
        "        recs = recommend_items_for_uid(u, k=K_RESP)\n",
        "    else:\n",
        "        model_version = \"pop_v1\"\n",
        "        recs = recommend_popularity(u, k=K_RESP)\n",
        "\n",
        "    exp_responses.append({\n",
        "        \"request_id\": req_id,\n",
        "        \"ts\": ts_req + 1,\n",
        "        \"user_id\": int(u),\n",
        "        \"arm\": assign,\n",
        "        \"status\": 200,\n",
        "        \"latency_ms\": int(np.random.randint(40,120)),\n",
        "        \"k\": K_RESP,\n",
        "        \"movie_ids\": json.dumps(recs),\n",
        "        \"model_version\": model_version,\n",
        "        \"data_snapshot_id\": data_snapshot_id,\n",
        "        \"pipeline_git_sha\": pipeline_git_sha,\n",
        "        \"container_image_digest\": container_image_digest,\n",
        "    })\n",
        "\n",
        "exp_requests  = pd.DataFrame(exp_requests)\n",
        "exp_responses = pd.DataFrame(exp_responses)\n",
        "\n",
        "from collections import defaultdict\n",
        "watch_index = defaultdict(list)\n",
        "for row in watch_events.itertuples(index=False):\n",
        "    watch_index[row.user_id].append((int(row.ts), int(row.movie_id)))\n",
        "\n",
        "def response_success(row) -> int:\n",
        "    u = row.user_id\n",
        "    t0, t1 = int(row.ts), int(row.ts) + success_window_secs\n",
        "    candidates = set(map(int, json.loads(row.movie_ids)))\n",
        "    for ts, mid in watch_index.get(u, []):\n",
        "        if t0 <= ts <= t1 and mid in candidates:\n",
        "            return 1\n",
        "    return 0\n",
        "\n",
        "exp_responses[\"success\"] = exp_responses.apply(response_success, axis=1)\n",
        "\n",
        "OUT_DIR = \"/content/out_eval\"\n",
        "os.makedirs(OUT_DIR, exist_ok=True)\n",
        "exp_requests.to_csv(os.path.join(OUT_DIR, \"ab_requests.csv\"), index=False)\n",
        "exp_responses.to_csv(os.path.join(OUT_DIR, \"ab_responses.csv\"), index=False)\n",
        "##printing the response\n",
        "print(\"A/B logs written to:\", OUT_DIR)\n",
        "exp_responses.head()"
      ],
      "metadata": {
        "id": "ogO9jHmB2zcz",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 503
        },
        "outputId": "8e2e3f65-d5a2-4525-ca4c-6df40f1a9abc"
      },
      "execution_count": 9,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "A/B logs written to: /content/out_eval\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                             request_id          ts  user_id    arm  status  \\\n",
              "0  4e1395ef-412c-4947-9894-03ba094894c9  1000085371        1  B_POP     200   \n",
              "1  fcf6c627-50e3-41cd-9358-c979e9689bc6  1000085431        4   A_CF     200   \n",
              "2  810ec8af-47e2-4401-9a2a-2faab1978f2e  1000085491        5  B_POP     200   \n",
              "3  354cf926-25e3-4361-8cdb-c861afaa787b  1000085551        7  B_POP     200   \n",
              "4  db0e9bf7-49cf-455b-9436-c010ebf0b592  1000085611        9  B_POP     200   \n",
              "\n",
              "   latency_ms   k                         movie_ids model_version  \\\n",
              "0          91  20         [19, 13, 3, 2, 10, 7, 15]        pop_v1   \n",
              "1          54  20   [14, 1, 9, 6, 2, 10, 7, 15, 20]        als_v1   \n",
              "2         111  20         [14, 1, 19, 13, 3, 10, 7]        pop_v1   \n",
              "3         100  20       [14, 1, 6, 3, 2, 10, 7, 20]        pop_v1   \n",
              "4          60  20  [14, 1, 9, 6, 19, 3, 10, 15, 20]        pop_v1   \n",
              "\n",
              "                           data_snapshot_id        pipeline_git_sha  \\\n",
              "0  440dd35fdf1ba80bb4a08fd2b45abba75d5dba77  git_sha_example_abcdef   \n",
              "1  440dd35fdf1ba80bb4a08fd2b45abba75d5dba77  git_sha_example_abcdef   \n",
              "2  440dd35fdf1ba80bb4a08fd2b45abba75d5dba77  git_sha_example_abcdef   \n",
              "3  440dd35fdf1ba80bb4a08fd2b45abba75d5dba77  git_sha_example_abcdef   \n",
              "4  440dd35fdf1ba80bb4a08fd2b45abba75d5dba77  git_sha_example_abcdef   \n",
              "\n",
              "                   container_image_digest  success  \n",
              "0  sha256:container_digest_example_123456        0  \n",
              "1  sha256:container_digest_example_123456        0  \n",
              "2  sha256:container_digest_example_123456        0  \n",
              "3  sha256:container_digest_example_123456        0  \n",
              "4  sha256:container_digest_example_123456        0  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-cf38b0c2-0e17-4abd-bd05-30651592705d\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>request_id</th>\n",
              "      <th>ts</th>\n",
              "      <th>user_id</th>\n",
              "      <th>arm</th>\n",
              "      <th>status</th>\n",
              "      <th>latency_ms</th>\n",
              "      <th>k</th>\n",
              "      <th>movie_ids</th>\n",
              "      <th>model_version</th>\n",
              "      <th>data_snapshot_id</th>\n",
              "      <th>pipeline_git_sha</th>\n",
              "      <th>container_image_digest</th>\n",
              "      <th>success</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>4e1395ef-412c-4947-9894-03ba094894c9</td>\n",
              "      <td>1000085371</td>\n",
              "      <td>1</td>\n",
              "      <td>B_POP</td>\n",
              "      <td>200</td>\n",
              "      <td>91</td>\n",
              "      <td>20</td>\n",
              "      <td>[19, 13, 3, 2, 10, 7, 15]</td>\n",
              "      <td>pop_v1</td>\n",
              "      <td>440dd35fdf1ba80bb4a08fd2b45abba75d5dba77</td>\n",
              "      <td>git_sha_example_abcdef</td>\n",
              "      <td>sha256:container_digest_example_123456</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>fcf6c627-50e3-41cd-9358-c979e9689bc6</td>\n",
              "      <td>1000085431</td>\n",
              "      <td>4</td>\n",
              "      <td>A_CF</td>\n",
              "      <td>200</td>\n",
              "      <td>54</td>\n",
              "      <td>20</td>\n",
              "      <td>[14, 1, 9, 6, 2, 10, 7, 15, 20]</td>\n",
              "      <td>als_v1</td>\n",
              "      <td>440dd35fdf1ba80bb4a08fd2b45abba75d5dba77</td>\n",
              "      <td>git_sha_example_abcdef</td>\n",
              "      <td>sha256:container_digest_example_123456</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>810ec8af-47e2-4401-9a2a-2faab1978f2e</td>\n",
              "      <td>1000085491</td>\n",
              "      <td>5</td>\n",
              "      <td>B_POP</td>\n",
              "      <td>200</td>\n",
              "      <td>111</td>\n",
              "      <td>20</td>\n",
              "      <td>[14, 1, 19, 13, 3, 10, 7]</td>\n",
              "      <td>pop_v1</td>\n",
              "      <td>440dd35fdf1ba80bb4a08fd2b45abba75d5dba77</td>\n",
              "      <td>git_sha_example_abcdef</td>\n",
              "      <td>sha256:container_digest_example_123456</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>354cf926-25e3-4361-8cdb-c861afaa787b</td>\n",
              "      <td>1000085551</td>\n",
              "      <td>7</td>\n",
              "      <td>B_POP</td>\n",
              "      <td>200</td>\n",
              "      <td>100</td>\n",
              "      <td>20</td>\n",
              "      <td>[14, 1, 6, 3, 2, 10, 7, 20]</td>\n",
              "      <td>pop_v1</td>\n",
              "      <td>440dd35fdf1ba80bb4a08fd2b45abba75d5dba77</td>\n",
              "      <td>git_sha_example_abcdef</td>\n",
              "      <td>sha256:container_digest_example_123456</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>db0e9bf7-49cf-455b-9436-c010ebf0b592</td>\n",
              "      <td>1000085611</td>\n",
              "      <td>9</td>\n",
              "      <td>B_POP</td>\n",
              "      <td>200</td>\n",
              "      <td>60</td>\n",
              "      <td>20</td>\n",
              "      <td>[14, 1, 9, 6, 19, 3, 10, 15, 20]</td>\n",
              "      <td>pop_v1</td>\n",
              "      <td>440dd35fdf1ba80bb4a08fd2b45abba75d5dba77</td>\n",
              "      <td>git_sha_example_abcdef</td>\n",
              "      <td>sha256:container_digest_example_123456</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cf38b0c2-0e17-4abd-bd05-30651592705d')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-cf38b0c2-0e17-4abd-bd05-30651592705d button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-cf38b0c2-0e17-4abd-bd05-30651592705d');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-691b2ccd-7b5a-4ddd-b46e-92bffc74b2fa\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-691b2ccd-7b5a-4ddd-b46e-92bffc74b2fa')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-691b2ccd-7b5a-4ddd-b46e-92bffc74b2fa button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "exp_responses",
              "summary": "{\n  \"name\": \"exp_responses\",\n  \"rows\": 6,\n  \"fields\": [\n    {\n      \"column\": \"request_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          \"4e1395ef-412c-4947-9894-03ba094894c9\",\n          \"fcf6c627-50e3-41cd-9358-c979e9689bc6\",\n          \"c66c9f63-d088-4f1b-99d9-935984c53884\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ts\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 112,\n        \"min\": 1000085371,\n        \"max\": 1000085671,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          1000085371,\n          1000085431,\n          1000085671\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"user_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3,\n        \"min\": 1,\n        \"max\": 10,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          1,\n          4,\n          10\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"arm\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"A_CF\",\n          \"B_POP\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"status\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 200,\n        \"max\": 200,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          200\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"latency_ms\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 25,\n        \"min\": 54,\n        \"max\": 114,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          91\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"k\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 20,\n        \"max\": 20,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          20\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"movie_ids\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 6,\n        \"samples\": [\n          \"[19, 13, 3, 2, 10, 7, 15]\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"model_version\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"als_v1\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"data_snapshot_id\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"440dd35fdf1ba80bb4a08fd2b45abba75d5dba77\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"pipeline_git_sha\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"git_sha_example_abcdef\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"container_image_digest\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"sha256:container_digest_example_123456\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"success\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 0,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import numpy as np, pandas as pd, json, math\n",
        "\n",
        "df = exp_responses.copy()\n",
        "agg = df.groupby(\"arm\")[\"success\"].agg([\"sum\",\"count\"])\n",
        "agg[\"rate\"] = agg[\"sum\"] / agg[\"count\"]\n",
        "display(agg)\n",
        "\n",
        "def two_prop_z_test(succ_a, n_a, succ_b, n_b, alternative=\"two-sided\"):\n",
        "    p_pool = (succ_a + succ_b) / (n_a + n_b)\n",
        "    se = math.sqrt(p_pool*(1-p_pool)*(1/n_a + 1/n_b))\n",
        "    if se == 0:\n",
        "        return 0.0, 1.0\n",
        "    z = ((succ_a/n_a) - (succ_b/n_b)) / se\n",
        "##the p value\n",
        "    from math import erf, sqrt\n",
        "    def phi(x):\n",
        "        return (1.0 + erf(x / math.sqrt(2.0))) / 2.0\n",
        "    if alternative == \"two-sided\":\n",
        "        p = 2*(1 - phi(abs(z)))\n",
        "    elif alternative == \"greater\":\n",
        "        p = 1 - phi(z)\n",
        "    else:\n",
        "        p = phi(z)\n",
        "    return z, p\n",
        "\n",
        "succ_A, n_A = int(agg.loc[\"A_CF\",\"sum\"]),   int(agg.loc[\"A_CF\",\"count\"])\n",
        "succ_B, n_B = int(agg.loc[\"B_POP\",\"sum\"]),  int(agg.loc[\"B_POP\",\"count\"])\n",
        "\n",
        "z, p = two_prop_z_test(succ_A, n_A, succ_B, n_B, alternative=\"two-sided\")\n",
        "delta = agg.loc[\"A_CF\",\"rate\"] - agg.loc[\"B_POP\",\"rate\"]\n",
        "print(f\"Two-proportion z-test (two-sided): z={z:.3f}, p={p:.4f}\")\n",
        "print(f\"Delta (A_CF - B_POP) conversion: {delta:.4%}\")\n",
        "\n",
        "def bootstrap_ci(success_a, n_a, success_b, n_b, B=2000, alpha=0.05):\n",
        "    ra = success_a / n_a\n",
        "    rb = success_b / n_b\n",
        "    deltas = []\n",
        "    for _ in range(B):\n",
        "        sa = np.random.binomial(n_a, ra)\n",
        "        sb = np.random.binomial(n_b, rb)\n",
        "        deltas.append((sa/n_a) - (sb/n_b))\n",
        "    lo = np.percentile(deltas, 100*alpha/2)\n",
        "    hi = np.percentile(deltas, 100*(1-alpha/2))\n",
        "    return float(lo), float(hi)\n",
        "\n",
        "lo, hi = bootstrap_ci(succ_A, n_A, succ_B, n_B, B=2000, alpha=0.05)\n",
        "##printing the bootsrap\n",
        "print(f\"Bootstrap 95% CI for delta: [{lo:.4%}, {hi:.4%}]\")\n",
        "\n",
        "\n",
        "if p < 0.05 and lo > 0:\n",
        "    decision = \"Ship A (CF): statistically significant lift over B (Popularity)\"\n",
        "elif p < 0.05 and hi < 0:\n",
        "    decision = \"Ship B (Popularity): statistically significant beat over A (CF)\"\n",
        "else:\n",
        "    decision = \"Inconclusive: need more data or iterate model; consider longer run\"\n",
        "\n",
        "print(\"Decision:\", decision)\n",
        "#provence\n",
        "print(\"\\n--- Provenance Trace (3 samples) ---\")\n",
        "trace_cols = [\"request_id\",\"user_id\",\"arm\",\"model_version\",\"data_snapshot_id\",\"pipeline_git_sha\",\"container_image_digest\",\"ts\",\"k\",\"movie_ids\",\"success\"]\n",
        "for _, row in df.sample(n=min(3, len(df)), random_state=42).iterrows():\n",
        "    print(json.dumps({c: (json.loads(row[c]) if c==\"movie_ids\" else row[c]) for c in trace_cols}, indent=2))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "id": "o2XUCVnoh2Nu",
        "outputId": "0ab7d26f-6db0-42e7-f307-27bdda0edd95"
      },
      "execution_count": 10,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "       sum  count  rate\n",
              "arm                    \n",
              "A_CF     0      2   0.0\n",
              "B_POP    0      4   0.0"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-b6678e71-e367-4b10-ad80-ff5d34b48fd0\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>sum</th>\n",
              "      <th>count</th>\n",
              "      <th>rate</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>arm</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>A_CF</th>\n",
              "      <td>0</td>\n",
              "      <td>2</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>B_POP</th>\n",
              "      <td>0</td>\n",
              "      <td>4</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b6678e71-e367-4b10-ad80-ff5d34b48fd0')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-b6678e71-e367-4b10-ad80-ff5d34b48fd0 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-b6678e71-e367-4b10-ad80-ff5d34b48fd0');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-02be0cce-12ff-4b7f-b2f3-1be811b2f1a4\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-02be0cce-12ff-4b7f-b2f3-1be811b2f1a4')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-02be0cce-12ff-4b7f-b2f3-1be811b2f1a4 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_8f7c353a-9581-4c2c-a93a-79ae910ebb82\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('agg')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_8f7c353a-9581-4c2c-a93a-79ae910ebb82 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('agg');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "agg",
              "summary": "{\n  \"name\": \"agg\",\n  \"rows\": 2,\n  \"fields\": [\n    {\n      \"column\": \"arm\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"B_POP\",\n          \"A_CF\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"sum\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 0,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"count\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 2,\n        \"max\": 4,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          4\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"rate\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.0,\n        \"min\": 0.0,\n        \"max\": 0.0,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Two-proportion z-test (two-sided): z=0.000, p=1.0000\n",
            "Delta (A_CF - B_POP) conversion: 0.0000%\n",
            "Bootstrap 95% CI for delta: [0.0000%, 0.0000%]\n",
            "Decision: Inconclusive: need more data or iterate model; consider longer run\n",
            "\n",
            "--- Provenance Trace (3 samples) ---\n",
            "{\n",
            "  \"request_id\": \"4e1395ef-412c-4947-9894-03ba094894c9\",\n",
            "  \"user_id\": 1,\n",
            "  \"arm\": \"B_POP\",\n",
            "  \"model_version\": \"pop_v1\",\n",
            "  \"data_snapshot_id\": \"440dd35fdf1ba80bb4a08fd2b45abba75d5dba77\",\n",
            "  \"pipeline_git_sha\": \"git_sha_example_abcdef\",\n",
            "  \"container_image_digest\": \"sha256:container_digest_example_123456\",\n",
            "  \"ts\": 1000085371,\n",
            "  \"k\": 20,\n",
            "  \"movie_ids\": [\n",
            "    19,\n",
            "    13,\n",
            "    3,\n",
            "    2,\n",
            "    10,\n",
            "    7,\n",
            "    15\n",
            "  ],\n",
            "  \"success\": 0\n",
            "}\n",
            "{\n",
            "  \"request_id\": \"fcf6c627-50e3-41cd-9358-c979e9689bc6\",\n",
            "  \"user_id\": 4,\n",
            "  \"arm\": \"A_CF\",\n",
            "  \"model_version\": \"als_v1\",\n",
            "  \"data_snapshot_id\": \"440dd35fdf1ba80bb4a08fd2b45abba75d5dba77\",\n",
            "  \"pipeline_git_sha\": \"git_sha_example_abcdef\",\n",
            "  \"container_image_digest\": \"sha256:container_digest_example_123456\",\n",
            "  \"ts\": 1000085431,\n",
            "  \"k\": 20,\n",
            "  \"movie_ids\": [\n",
            "    14,\n",
            "    1,\n",
            "    9,\n",
            "    6,\n",
            "    2,\n",
            "    10,\n",
            "    7,\n",
            "    15,\n",
            "    20\n",
            "  ],\n",
            "  \"success\": 0\n",
            "}\n",
            "{\n",
            "  \"request_id\": \"c66c9f63-d088-4f1b-99d9-935984c53884\",\n",
            "  \"user_id\": 10,\n",
            "  \"arm\": \"A_CF\",\n",
            "  \"model_version\": \"als_v1\",\n",
            "  \"data_snapshot_id\": \"440dd35fdf1ba80bb4a08fd2b45abba75d5dba77\",\n",
            "  \"pipeline_git_sha\": \"git_sha_example_abcdef\",\n",
            "  \"container_image_digest\": \"sha256:container_digest_example_123456\",\n",
            "  \"ts\": 1000085671,\n",
            "  \"k\": 20,\n",
            "  \"movie_ids\": [\n",
            "    1,\n",
            "    19,\n",
            "    13,\n",
            "    3,\n",
            "    2,\n",
            "    15,\n",
            "    20\n",
            "  ],\n",
            "  \"success\": 0\n",
            "}\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import numpy as np\n",
        "import pandas as pd\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "RATING_THRESHOLD = 3.5\n",
        "np.random.seed(42)\n",
        "\n",
        "try:\n",
        "    ratings\n",
        "    assert {\"userId\",\"movieId\",\"rating\",\"timestamp\"}.issubset(ratings.columns)\n",
        "    print(\"Using existing 'ratings' DataFrame:\", ratings.shape)\n",
        "except Exception:\n",
        "    print(\"No valid ratings found, creating a small synthetic dataset.\")\n",
        "    users  = np.arange(1, 31)\n",
        "    movies = np.arange(1, 51)\n",
        "    rows = []\n",
        "    now = int(1.7e9)\n",
        "    for u in users:\n",
        "        n = np.random.randint(10, 25)\n",
        "        rated = np.random.choice(movies, size=n, replace=False)\n",
        "        for m in rated:\n",
        "            rows.append({\n",
        "                \"userId\": u,\n",
        "                \"movieId\": m,\n",
        "                \"rating\": np.random.randint(1, 6),\n",
        "                \"timestamp\": now - np.random.randint(0, 100000)\n",
        "            })\n",
        "    ratings = pd.DataFrame(rows)\n",
        "    print(\"Synthetic ratings:\", ratings.shape)\n",
        "\n",
        "cutoff_ts = np.quantile(ratings[\"timestamp\"].values, 0.8)\n",
        "train_df = ratings[ratings[\"timestamp\"] <= cutoff_ts].copy()\n",
        "test_df  = ratings[ratings[\"timestamp\"] >  cutoff_ts].copy()\n",
        "\n",
        "print(\"Train/Test sizes:\", train_df.shape, test_df.shape)\n",
        "\n",
        "train_pos = train_df[train_df[\"rating\"] >= RATING_THRESHOLD].copy()\n",
        "pop_counts = train_pos.groupby(\"movieId\")[\"userId\"].count().sort_values(ascending=False)\n",
        "pop_ranking = pop_counts.index.to_numpy()\n",
        "\n",
        "def recommend_base(uid: int, k: int = 20) -> list:\n",
        "    \"\"\"\n",
        "    Simple popularity recommender:\n",
        "    - Recommend most popular movies the user hasn't seen in TRAIN.\n",
        "    \"\"\"\n",
        "    seen = set(train_df.loc[train_df[\"userId\"] == uid, \"movieId\"].values)\n",
        "    recs = [int(m) for m in pop_ranking if m not in seen]\n",
        "    return recs[:k]\n",
        "\n",
        "eval_users = sorted(test_df[\"userId\"].unique())\n",
        "print(\"Eval users:\", len(eval_users))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "JkqyvU-_lZTH",
        "outputId": "7d6ca903-23ae-45cb-b16f-e982024fbd6d"
      },
      "execution_count": 12,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "No valid ratings found, creating a small synthetic dataset.\n",
            "Synthetic ratings: (507, 4)\n",
            "Train/Test sizes: (405, 4) (102, 4)\n",
            "Eval users: 29\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "\n",
        "pop_counts = train_pos.groupby(\"movieId\")[\"userId\"].count().sort_values(ascending=False)\n",
        "n_items = len(pop_counts)\n",
        "head_cut = int(0.2 * n_items)\n",
        "mid_cut  = int(0.5 * n_items)\n",
        "\n",
        "head_items = set(pop_counts.index[:head_cut])\n",
        "mid_items  = set(pop_counts.index[head_cut:mid_cut])\n",
        "tail_items = set(pop_counts.index[mid_cut:])\n",
        "\n",
        "pop_norm = (pop_counts - pop_counts.min()) / (pop_counts.max() - pop_counts.min() + 1e-9)\n",
        "\n",
        "def popularity_tier(mid):\n",
        "    if mid in head_items: return \"Head\"\n",
        "    if mid in mid_items:  return \"Mid\"\n",
        "    return \"Tail\"\n",
        "\n",
        "print(\"Popularity tiers:\",\n",
        "      f\"Head={len(head_items)}, Mid={len(mid_items)}, Tail={len(tail_items)}\")\n",
        "\n",
        "def recommend_fair(uid: int,\n",
        "                   k: int = 20,\n",
        "                   candidate_mult: int = 5,\n",
        "                   beta_pop: float = 0.7,\n",
        "                   tail_boost: float = 0.3) -> list:\n",
        "    \"\"\"\n",
        "    Fair recommender:\n",
        "      1) Start from base popularity candidates.\n",
        "      2) Penalize Head items using normalized popularity.\n",
        "      3) Give a small bonus to Tail items.\n",
        "    \"\"\"\n",
        "    cand_k = k * candidate_mult\n",
        "    base_recs = recommend_base(uid, k=cand_k)\n",
        "    if not base_recs:\n",
        "        return base_recs\n",
        "\n",
        "    scores = {}\n",
        "    for rank, mid in enumerate(base_recs):\n",
        "        base_score = 1.0 / (rank + 1)\n",
        "        p = pop_norm.get(mid, 0.0)\n",
        "        penalty = beta_pop * p\n",
        "        bonus = tail_boost if mid in tail_items else 0.0\n",
        "        scores[mid] = base_score - penalty + bonus\n",
        "\n",
        "    reranked = sorted(scores.items(), key=lambda x: x[1], reverse=True)\n",
        "    return [mid for mid, _ in reranked[:k]]\n",
        "\n",
        "def exposure_by_tier(recommender, k: int = 20):\n",
        "    exposure = {\"Head\": 0, \"Mid\": 0, \"Tail\": 0}\n",
        "    total = 0\n",
        "    for u in eval_users:\n",
        "        recs = recommender(u, k=k)\n",
        "        for m in recs:\n",
        "            exposure[popularity_tier(m)] += 1\n",
        "            total += 1\n",
        "    shares = {g: exposure[g] / total for g in exposure}\n",
        "    df = pd.DataFrame({\"tier\": list(shares.keys()),\n",
        "                       \"share\": list(shares.values())})\n",
        "    return df, shares\n",
        "\n",
        "base_exp_df, base_shares = exposure_by_tier(recommend_base, k=20)\n",
        "fair_exp_df, fair_shares = exposure_by_tier(recommend_fair,  k=20)\n",
        "\n",
        "print(\"Base exposure:\")\n",
        "display(base_exp_df)\n",
        "print(\"Fair exposure:\")\n",
        "display(fair_exp_df)\n",
        "\n",
        "def check_req_S1(shares):\n",
        "    max_share = max(shares.values())\n",
        "    return max_share, (max_share <= 0.40)\n",
        "\n",
        "max_base, ok_base = check_req_S1(base_shares)\n",
        "max_fair, ok_fair = check_req_S1(fair_shares)\n",
        "print(f\"Base max tier share = {max_base:.2%}  → S1 met? {ok_base}\")\n",
        "print(f\"Fair max tier share = {max_fair:.2%}  → S1 met? {ok_fair}\")\n",
        "\n",
        "fig, ax = plt.subplots(1, 2, figsize=(8,3), sharey=True)\n",
        "ax[0].bar(base_exp_df[\"tier\"], base_exp_df[\"share\"])\n",
        "ax[0].set_title(\"Base exposure\")\n",
        "ax[1].bar(fair_exp_df[\"tier\"], fair_exp_df[\"share\"])\n",
        "ax[1].set_title(\"Fair exposure\")\n",
        "for a in ax:\n",
        "    a.set_ylim(0, 1.0)\n",
        "    a.set_ylabel(\"Exposure share\")\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 646
        },
        "id": "r6kBP1QYxoFu",
        "outputId": "ae07c3f2-b509-4a99-a8c4-81ff71ebfa71"
      },
      "execution_count": 13,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Popularity tiers: Head=9, Mid=15, Tail=25\n",
            "Base exposure:\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "   tier     share\n",
              "0  Head  0.286207\n",
              "1   Mid  0.543103\n",
              "2  Tail  0.170690"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-d1f3e51d-0109-4f83-8f9d-d4e86248da30\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>tier</th>\n",
              "      <th>share</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>Head</td>\n",
              "      <td>0.286207</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>Mid</td>\n",
              "      <td>0.543103</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>Tail</td>\n",
              "      <td>0.170690</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d1f3e51d-0109-4f83-8f9d-d4e86248da30')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-d1f3e51d-0109-4f83-8f9d-d4e86248da30 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-d1f3e51d-0109-4f83-8f9d-d4e86248da30');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-65e95524-210b-49c3-b473-d81a9b31c801\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-65e95524-210b-49c3-b473-d81a9b31c801')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-65e95524-210b-49c3-b473-d81a9b31c801 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_72960298-9e7c-4096-8e66-23b8ef67946b\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('base_exp_df')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_72960298-9e7c-4096-8e66-23b8ef67946b button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('base_exp_df');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "base_exp_df",
              "summary": "{\n  \"name\": \"base_exp_df\",\n  \"rows\": 3,\n  \"fields\": [\n    {\n      \"column\": \"tier\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"Head\",\n          \"Mid\",\n          \"Tail\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"share\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.19062708125086203,\n        \"min\": 0.1706896551724138,\n        \"max\": 0.5431034482758621,\n        \"num_unique_values\": 3,\n        \"samples\": [\n          0.28620689655172415,\n          0.5431034482758621,\n          0.1706896551724138\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Fair exposure:\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "   tier     share\n",
              "0  Head  0.079310\n",
              "1   Mid  0.013793\n",
              "2  Tail  0.906897"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-de261fc1-2d4e-4eae-94c7-06c198ca5f28\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>tier</th>\n",
              "      <th>share</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>Head</td>\n",
              "      <td>0.079310</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>Mid</td>\n",
              "      <td>0.013793</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>Tail</td>\n",
              "      <td>0.906897</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-de261fc1-2d4e-4eae-94c7-06c198ca5f28')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-de261fc1-2d4e-4eae-94c7-06c198ca5f28 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-de261fc1-2d4e-4eae-94c7-06c198ca5f28');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-69f1c2f3-bf1e-4d8f-82a2-d948ac689717\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-69f1c2f3-bf1e-4d8f-82a2-d948ac689717')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-69f1c2f3-bf1e-4d8f-82a2-d948ac689717 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_397adec0-1b82-4dfc-855d-9c9970a55afa\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('fair_exp_df')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_397adec0-1b82-4dfc-855d-9c9970a55afa button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('fair_exp_df');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "fair_exp_df",
              "summary": "{\n  \"name\": \"fair_exp_df\",\n  \"rows\": 3,\n  \"fields\": [\n    {\n      \"column\": \"tier\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"Head\",\n          \"Mid\",\n          \"Tail\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"share\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.49779935852469925,\n        \"min\": 0.013793103448275862,\n        \"max\": 0.906896551724138,\n        \"num_unique_values\": 3,\n        \"samples\": [\n          0.07931034482758621,\n          0.013793103448275862,\n          0.906896551724138\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Base max tier share = 54.31%  → S1 met? False\n",
            "Fair max tier share = 90.69%  → S1 met? False\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 800x300 with 2 Axes>"
            ],
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAAxYAAAEiCAYAAABkykQ1AAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAOepJREFUeJzt3XlclPX6//H3gDLgAi4oJKF4RFPcxSOhlaYmKmpaKi7lkmtpavyOKS1aWi7nmGmumYl1ysLUrKNFKunJjNJcOyfXkjATcAMEFRTu3x9+ndMEGOOAA8Pr+XjM49F85nPf9zVz23Vxzb2MyTAMQwAAAABgBxdHBwAAAACg9KOxAAAAAGA3GgsAAAAAdqOxAAAAAGA3GgsAAAAAdqOxAAAAAGA3GgsAAAAAdqOxAAAAAGA3GgsAAAAAdqOxAAAAZcKOHTtkMpm0Y8cOR4cCOCUaC5Qaq1evlslksnrUrFlTDz74oD7//HNHhwcAKCb55f+bj6lTpzo6PAD/p5yjAwBsNWPGDNWtW1eGYSg5OVmrV69W9+7d9a9//Us9evRwdHgAgGJyM///XpMmTQq9/AMPPKArV67Izc2tqEMDIBoLlELdunVT69atLc9HjBghHx8fffDBBzQWJVBubq6ys7Pl7u7u6FAAlHJ/zP+2cnFxKVQuunz5sipUqHDb23FmhmHo6tWr8vDwcHQoKIE4FQqlXpUqVeTh4aFy5az75Hnz5qlt27aqXr26PDw8FBwcrHXr1uVZfuvWrbrvvvtUpUoVVapUSffcc4+ee+45qzlZWVmaPn26AgMDZTab5e/vr2effVZZWVmFivG7775T165d5eXlpQoVKqh9+/batWuX5fXDhw/Lw8NDQ4YMsVru66+/lqurq6ZMmWIZCwgIUI8ePbRlyxa1aNFC7u7uCgoK0oYNG/Js9+eff1a/fv1UrVo1VahQQffee682b96cZ96iRYvUuHFjVahQQVWrVlXr1q21Zs0ay+vDhg1TQEBAnuVeeuklmUwmqzGTyaTx48fr/fffV+PGjWU2mxUbGytJOn36tJ544gn5+PjIbDarcePGWrVqVaE+QwAoyC+//KKnnnpK99xzjzw8PFS9enX169dPCQkJVvPyu8aiQ4cOatKkifbu3asHHnhAFSpUyFMD/ujIkSPq27evqlWrJnd3d7Vu3Vqffvqp5fWUlBTVqFFDHTp0kGEYlvETJ06oYsWKioiIyHf7bdu2lYeHh+rWravly5fn2W5KSorlyzR3d3c1b95c77zzTp55H374oYKDg1W5cmV5enqqadOmWrhwoeX1/HK39L9Tzn7/ud2sOV988YVat24tDw8Pvfnmm5Kk1NRUTZo0Sf7+/jKbzQoMDNTcuXOVm5t7y88PzosjFih10tLSdO7cORmGoZSUFC1atEgZGRl67LHHrOYtXLhQvXr10uDBg5Wdna0PP/xQ/fr106ZNmxQeHi5J+u9//6sePXqoWbNmmjFjhsxms06cOGH1R39ubq569eqlr7/+WqNHj1ajRo30ww8/6PXXX9exY8e0cePGW8b75Zdfqlu3bgoODtb06dPl4uKi6OhodezYUTt37lSbNm3UqFEjzZw5U5MnT1bfvn3Vq1cvZWZmatiwYWrYsKFmzJhhtc7jx48rIiJCY8eO1dChQxUdHa1+/fopNjZWDz30kCQpOTlZbdu21eXLlzVhwgRVr15d77zzjnr16qV169apT58+kqS33npLEyZMUN++fTVx4kRdvXpVhw4d0nfffadBgwbd1j768ssvtXbtWo0fP17e3t4KCAhQcnKy7r33XkvjUaNGDX3++ecaMWKE0tPTNWnSpNvaFoCy42b+/z1vb2/t2bNH33zzjQYMGKC7775bCQkJWrZsmTp06KAff/zxT48+nD9/Xt26ddOAAQP02GOPycfHp8C5//3vf9WuXTv5+flp6tSpqlixotauXavevXtr/fr16tOnj2rWrKlly5apX79+WrRokSZMmKDc3FwNGzZMlStX1tKlS63WefHiRXXv3l39+/fXwIEDtXbtWj355JNyc3PTE088IUm6cuWKOnTooBMnTmj8+PGqW7euPvroIw0bNkypqamaOHGipBtflg0cOFCdOnXS3LlzJd348mrXrl2WObY6evSoBg4cqDFjxmjUqFG65557dPnyZbVv316nT5/WmDFjVLt2bX3zzTeKiorSmTNntGDBgtvaFko5AygloqOjDUl5Hmaz2Vi9enWe+ZcvX7Z6np2dbTRp0sTo2LGjZez11183JBlnz54tcLv//Oc/DRcXF2Pnzp1W48uXLzckGbt27Spw2dzcXKN+/fpGWFiYkZubaxVb3bp1jYceesgylpOTY9x3332Gj4+Pce7cOWPcuHFGuXLljD179lit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50Sudw7k+sKhsXACrVq10o8//pinIN30ww8/6Pz585ozZ478/f0lSd9//73VnEaNGunTTz+1Gvv222+LJ2BIkrp27ars7GyZTCaFhYXdcm7Dhg11/fp17d27V3/9618lSUePHuUWlCXArl27NGzYMPXp00fSjT/+uBgWxYFcXzqR650Dub5wuHjbCUyZMkXffPONxo8frwMHDuj48eP65JNPLN+Q1K5dW25ublq0aJF+/vlnffrpp3numT127FgdP35ckydP1tGjR7VmzRqtXr3aAe+m7HB1ddXhw4f1448/ytXV9ZZz77nnHnXt2lVjxozRd999p71792rkyJGWWxjCcerXr68NGzbowIEDOnjwoAYNGmQ5/QQoSuT60olc7xzI9YVDY+EEmjVrpn//+986duyY7r//frVs2VLTpk1TrVq1JN04x3P16tX66KOPFBQUpDlz5mjevHlW66hdu7bWr1+vjRs3qnnz5lq+fLlmzZrliLdTpnh6esrT07NQc6Ojo1WrVi21b99ejzzyiEaPHq2aNWsWc4T4M/Pnz1fVqlXVtm1b9ezZU2FhYWrVqpWjw4ITIteXXuT60o9cXzgmwzAMRwcBAAAAoHTjiAUAAAAAu9FYAAAAALAbjQUAAAAAu9FYAAAAALAbjQUAAAAAu9FYAAAAALAbjQUAAAAAu9FYAAAAALAbjQUAAAAAu9FYAAAAALAbjQUAAAAAu9FYAAAAALDb/wf5wLlNZwsCvgAAAABJRU5ErkJggg==\n"
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from collections import defaultdict\n",
        "import math\n",
        "\n",
        "K_NDCG = 10\n",
        "\n",
        "test_pos = test_df[test_df[\"rating\"] >= RATING_THRESHOLD].copy()\n",
        "truth = defaultdict(set)\n",
        "for u, mid in zip(test_pos[\"userId\"].values, test_pos[\"movieId\"].values):\n",
        "    truth[u].add(mid)\n",
        "\n",
        "train_user_pos = train_pos.groupby(\"userId\")[\"movieId\"].nunique()\n",
        "\n",
        "def bucket(n):\n",
        "    if n < 10: return \"cold(<10)\"\n",
        "    elif n < 50: return \"warm(10-49)\"\n",
        "    else: return \"hot(50+)\"\n",
        "\n",
        "user_bucket = {u: bucket(n) for u, n in train_user_pos.items()}\n",
        "\n",
        "def ndcg_at_k(recs, truth_set, k):\n",
        "    def dcg(rs):\n",
        "        s = 0.0\n",
        "        for i, m in enumerate(rs[:k], start=1):\n",
        "            if m in truth_set:\n",
        "                s += 1.0 / math.log2(i+1)\n",
        "        return s\n",
        "    if not truth_set:\n",
        "        return 0.0\n",
        "    ideal = sum(1.0 / math.log2(i+1) for i in range(1, min(k, len(truth_set)) + 1))\n",
        "    return dcg(recs) / ideal\n",
        "\n",
        "rows = []\n",
        "for u in eval_users:\n",
        "    tset = truth[u]\n",
        "    if not tset:\n",
        "        continue\n",
        "    b = user_bucket.get(u, \"unknown\")\n",
        "    base_recs = recommend_base(u, k=K_NDCG)\n",
        "    fair_recs = recommend_fair(u, k=K_NDCG)\n",
        "    rows.append({\n",
        "        \"userId\": u,\n",
        "        \"bucket\": b,\n",
        "        \"ndcg_base\": ndcg_at_k(base_recs, tset, K_NDCG),\n",
        "        \"ndcg_fair\": ndcg_at_k(fair_recs, tset, K_NDCG)\n",
        "    })\n",
        "\n",
        "fair_ndcg_df = pd.DataFrame(rows)\n",
        "display(fair_ndcg_df.head())\n",
        "\n",
        "summary = fair_ndcg_df.groupby(\"bucket\")[[\"ndcg_base\",\"ndcg_fair\"]].mean().reset_index()\n",
        "print(\"NDCG@10 by bucket (Base vs Fair):\")\n",
        "display(summary)\n",
        "\n",
        "cold_ndcg = float(summary.loc[summary[\"bucket\"]==\"cold(<10)\",\"ndcg_fair\"])\n",
        "warm_ndcg = float(summary.loc[summary[\"bucket\"]==\"warm(10-49)\",\"ndcg_fair\"])\n",
        "ratio = cold_ndcg / warm_ndcg if warm_ndcg > 0 else np.nan\n",
        "print(f\"Fair model cold NDCG = {cold_ndcg:.4f}, warm NDCG = {warm_ndcg:.4f}\")\n",
        "print(f\"Cold/Warm NDCG ratio (M1) = {ratio:.2f}  → meets ≥0.70 ? {ratio >= 0.70}\")\n",
        "\n",
        "summary.plot(x=\"bucket\", y=[\"ndcg_base\",\"ndcg_fair\"], kind=\"bar\")\n",
        "plt.title(\"NDCG@10 Fairness by User Bucket\")\n",
        "plt.ylabel(\"Mean NDCG@10\")\n",
        "plt.tight_layout()\n",
        "plt.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 912
        },
        "id": "usVjxGCVx1GL",
        "outputId": "9d97ee08-b51a-49ed-a296-82e7800692d5"
      },
      "execution_count": 14,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "   userId     bucket  ndcg_base  ndcg_fair\n",
              "0       1  cold(<10)   0.000000        0.0\n",
              "1       2  cold(<10)   0.386853        0.0\n",
              "2       3  cold(<10)   0.369268        0.0\n",
              "3       4  cold(<10)   0.500000        0.0\n",
              "4       5  cold(<10)   0.000000        0.0"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-17eab906-e5a2-497f-a842-4d76c9a6e26d\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>userId</th>\n",
              "      <th>bucket</th>\n",
              "      <th>ndcg_base</th>\n",
              "      <th>ndcg_fair</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.386853</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.369268</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.500000</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-17eab906-e5a2-497f-a842-4d76c9a6e26d')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-17eab906-e5a2-497f-a842-4d76c9a6e26d button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-17eab906-e5a2-497f-a842-4d76c9a6e26d');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-6f528b97-d65c-4c22-8c11-594555c3523f\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-6f528b97-d65c-4c22-8c11-594555c3523f')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-6f528b97-d65c-4c22-8c11-594555c3523f button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "summary": "{\n  \"name\": \"plt\",\n  \"rows\": 5,\n  \"fields\": [\n    {\n      \"column\": \"userId\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 1,\n        \"max\": 5,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          2,\n          5,\n          3\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"bucket\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"cold(<10)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ndcg_base\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.2347583901293582,\n        \"min\": 0.0,\n        \"max\": 0.5,\n        \"num_unique_values\": 4,\n        \"samples\": [\n          0.38685280723454163\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ndcg_fair\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.0,\n        \"min\": 0.0,\n        \"max\": 0.0,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "NDCG@10 by bucket (Base vs Fair):\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "        bucket  ndcg_base  ndcg_fair\n",
              "0    cold(<10)   0.194273   0.098514\n",
              "1  warm(10-49)   0.187953   0.101054"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-4a2098e3-498f-4d42-b76b-9bb144ab03e3\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>bucket</th>\n",
              "      <th>ndcg_base</th>\n",
              "      <th>ndcg_fair</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>cold(&lt;10)</td>\n",
              "      <td>0.194273</td>\n",
              "      <td>0.098514</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>warm(10-49)</td>\n",
              "      <td>0.187953</td>\n",
              "      <td>0.101054</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4a2098e3-498f-4d42-b76b-9bb144ab03e3')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-4a2098e3-498f-4d42-b76b-9bb144ab03e3 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-4a2098e3-498f-4d42-b76b-9bb144ab03e3');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-6bd1e0c1-316f-439b-903f-0e865f6bb560\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-6bd1e0c1-316f-439b-903f-0e865f6bb560')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-6bd1e0c1-316f-439b-903f-0e865f6bb560 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "  <div id=\"id_c7b92e67-321c-4eef-ab31-73d4696ba9e7\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('summary')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_c7b92e67-321c-4eef-ab31-73d4696ba9e7 button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('summary');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "summary",
              "summary": "{\n  \"name\": \"summary\",\n  \"rows\": 2,\n  \"fields\": [\n    {\n      \"column\": \"bucket\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"warm(10-49)\",\n          \"cold(<10)\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ndcg_base\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.004468876228350886,\n        \"min\": 0.18795316793560363,\n        \"max\": 0.19427311330630417,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0.18795316793560363,\n          0.19427311330630417\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"ndcg_fair\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.0017956226250234642,\n        \"min\": 0.09851427938106162,\n        \"max\": 0.10105367325027378,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0.10105367325027378,\n          0.09851427938106162\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Fair model cold NDCG = 0.0985, warm NDCG = 0.1011\n",
            "Cold/Warm NDCG ratio (M1) = 0.97  → meets ≥0.70 ? True\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/tmp/ipython-input-975857698.py:54: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead\n",
            "  cold_ndcg = float(summary.loc[summary[\"bucket\"]==\"cold(<10)\",\"ndcg_fair\"])\n",
            "/tmp/ipython-input-975857698.py:55: FutureWarning: Calling float on a single element Series is deprecated and will raise a TypeError in the future. Use float(ser.iloc[0]) instead\n",
            "  warm_ndcg = float(summary.loc[summary[\"bucket\"]==\"warm(10-49)\",\"ndcg_fair\"])\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 640x480 with 1 Axes>"
            ],
            "image/png": "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\n"
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "rYMECD86yVK-"
      },
      "execution_count": null,
      "outputs": []
    }
  ]
}
